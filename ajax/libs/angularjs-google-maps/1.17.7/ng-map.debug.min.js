angular.module("ngMap",[]),function(){"use strict";function e(d,f,v,y,e,h,M){w=e;var b=this;b.mapOptions,b.mapEvents,b.eventListeners,b.addObject=function(e,t){var n;b.map&&(b.map[e]=b.map[e]||{},n=Object.keys(b.map[e]).length,b.map[e][t.id||n]=t,b.map instanceof google.maps.Map&&("infoWindows"!=e&&t.setMap&&t.setMap&&t.setMap(b.map),t.centered&&t.position&&b.map.setCenter(t.position),"markers"==e&&b.objectChanged("markers"),"customMarkers"==e&&b.objectChanged("customMarkers")))},b.deleteObject=function(e,t){if(t.map){var n=t.map[e];for(var o in n)n[o]===t&&(console.log("Deleting",e,t),google.maps.event.clearInstanceListeners(t),delete n[o]);t.map&&t.setMap&&t.setMap(null),"markers"==e&&b.objectChanged("markers"),"customMarkers"==e&&b.objectChanged("customMarkers")}},b.observeAttrSetObj=function(e,t,n){if(t.noWatcher)return!1;for(var o=w.getAttrsToObserve(e),a=0;a<o.length;a++){var i=o[a];t.$observe(i,h.observeAndSet(i,n))}},b.zoomToIncludeMarkers=function(){if(null!=b.map.markers&&0<Object.keys(b.map.markers).length||null!=b.map.customMarkers&&0<Object.keys(b.map.customMarkers).length){var e=new google.maps.LatLngBounds;for(var t in b.map.markers)e.extend(b.map.markers[t].getPosition());for(var n in b.map.customMarkers)e.extend(b.map.customMarkers[n].getPosition());b.mapOptions.maximumZoom&&(b.enableMaximumZoomCheck=!0),b.map.fitBounds(e)}},b.objectChanged=function(e){!b.map||"markers"!=e&&"customMarkers"!=e||"auto"!=b.map.zoomToIncludeMarkers||b.zoomToIncludeMarkers()},b.initializeMap=function(){var n=b.mapOptions,e=b.mapEvents,t=b.map;if(b.map=M.getMapInstance(f[0]),h.setStyle(f[0]),t){var o=w.filter(v),a=w.getOptions(o),i=w.getControlOptions(o),n=angular.extend(a,i);for(var r in console.log("map options",n),t){var s=t[r];if("object"==typeof s)for(var p in s)b.addObject(r,s[p])}b.map.showInfoWindow=b.showInfoWindow,b.map.hideInfoWindow=b.hideInfoWindow}n.zoom=n.zoom||15;var c,l=n.center;for(var u in!n.center||"string"==typeof l&&l.match(/\{\{.*\}\}/)?n.center=new google.maps.LatLng(0,0):l instanceof google.maps.LatLng||(c=n.center,delete n.center,h.getGeoLocation(c,n.geoLocationOptions).then(function(e){b.map.setCenter(e);var t=n.geoCallback;t&&y(t)(d)},function(){n.geoFallbackCenter&&b.map.setCenter(n.geoFallbackCenter)})),b.map.setOptions(n),e){var g=e[u],m=google.maps.event.addListener(b.map,u,g);b.eventListeners[u]=m}b.observeAttrSetObj(O,v,b.map),b.singleInfoWindow=n.singleInfoWindow,google.maps.event.trigger(b.map,"resize"),google.maps.event.addListenerOnce(b.map,"idle",function(){h.addMap(b),n.zoomToIncludeMarkers&&b.zoomToIncludeMarkers(),d.map=b.map,d.$emit("mapInitialized",b.map),v.mapInitialized&&y(v.mapInitialized)(d,{map:b.map})}),n.zoomToIncludeMarkers&&n.maximumZoom&&google.maps.event.addListener(b.map,"zoom_changed",function(){1==b.enableMaximumZoomCheck&&(b.enableMaximumZoomCheck=!1,google.maps.event.addListenerOnce(b.map,"bounds_changed",function(){b.map.setZoom(Math.min(n.maximumZoom,b.map.getZoom()))}))})},d.google=google;var t,n,O=w.orgAttributes(f),o=w.filter(v),a=w.getOptions(o,{scope:d}),i=w.getControlOptions(o),r=angular.extend(a,i),s=w.getEvents(d,o);console.log("ng-map Options",r),Object.keys(s).length&&console.log("ng-map Events",s),b.mapOptions=r,b.mapEvents=s,b.eventListeners={},a.lazyInit?(n=v.id&&0===v.id.indexOf("{{",0)&&-1!==v.id.indexOf("}}",v.id.length-"}}".length)?(t=v.id.slice(2,-2),y(t)(d)):v.id,b.map={id:n},h.addMap(b)):b.initializeMap(),a.triggerResize&&google.maps.event.trigger(b.map,"resize"),f.bind("$destroy",function(){M.returnMapInstance(b.map),h.deleteMap(b)})}var w;e.$inject=["$scope","$element","$attrs","$parse","Attr2MapOptions","NgMap","NgMapPool"],angular.module("ngMap").controller("__MapController",e)}(),function(){"use strict";function t(e,t,n,o){o=o[0]||o[1];var a=c.orgAttributes(t),i=c.filter(n),r=c.getOptions(i,{scope:e}),s=c.getEvents(e,i);console.log("bicycling-layer options",r,"events",s);var p=l(r,s);o.addObject("bicyclingLayers",p),o.observeAttrSetObj(a,n,p),t.bind("$destroy",function(){o.deleteObject("bicyclingLayers",p)})}function e(e){return c=e,{restrict:"E",require:["?^map","?^ngMap"],link:t}}var c,l=function(e,t){var n=new google.maps.BicyclingLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n};e.$inject=["Attr2MapOptions"],angular.module("ngMap").directive("bicyclingLayer",e)}(),function(){"use strict";function o(e,t,n,o){o=o[0]||o[1];var a=l.filter(n),i=l.getOptions(a,{scope:e}),r=l.getEvents(e,a),s=t[0].parentElement.removeChild(t[0]);for(var p in u(s.innerHTML.trim())(e),r)google.maps.event.addDomListener(s,p,r[p]);o.addObject("customControls",s);var c=i.position;o.map.controls[google.maps.ControlPosition[c]].push(s),t.bind("$destroy",function(){o.deleteObject("customControls",s)})}function e(e,t,n){return l=e,u=t,{restrict:"E",require:["?^map","?^ngMap"],link:o}}var l,u;e.$inject=["Attr2MapOptions","$compile","NgMap"],angular.module("ngMap").directive("customControl",e)}(),function(){"use strict";function g(e){for(var t in e=e||{},this.el=document.createElement("div"),this.el.style.display="inline-block",this.el.style.visibility="hidden",this.visible=!0,e)this[t]=e[t]}function e(e,t,n,o){return m=n,d=e,a=t,f=o,{restrict:"E",require:["?^map","?^ngMap"],compile:function(e){(g.prototype=new google.maps.OverlayView).setContent=function(e,t){this.el.innerHTML=e,this.el.style.position="absolute",t&&a(angular.element(this.el).contents())(t)},g.prototype.getDraggable=function(){return this.draggable},g.prototype.setDraggable=function(e){this.draggable=e},g.prototype.getPosition=function(){return this.position},g.prototype.setPosition=function(e){var o,t;e&&(this.position=e),this.getProjection()&&"function"==typeof this.position.lng&&(t=function(){var e=o.getProjection().fromLatLngToDivPixel(o.position),t=Math.round(e.x-o.el.offsetWidth/2),n=Math.round(e.y-o.el.offsetHeight-10);o.el.style.left=t+"px",o.el.style.top=n+"px",o.el.style.visibility="visible"},(o=this).el.offsetWidth&&o.el.offsetHeight?t():d(t,300))},g.prototype.setZIndex=function(e){e&&(this.zIndex=e),this.el.style.zIndex=this.zIndex},g.prototype.getVisible=function(){return this.visible},g.prototype.setVisible=function(e){this.el.style.display=e?"inline-block":"none",this.visible=e},g.prototype.addClass=function(e){var t=this.el.className.trim().split(" ");-1==t.indexOf(e)&&t.push(e),this.el.className=t.join(" ")},g.prototype.removeClass=function(e){var t=this.el.className.split(" "),n=t.indexOf(e);-1<n&&t.splice(n,1),this.el.className=t.join(" ")},g.prototype.onAdd=function(){this.getPanes().overlayMouseTarget.appendChild(this.el)},g.prototype.draw=function(){this.setPosition(),this.setZIndex(this.zIndex),this.setVisible(this.visible)},g.prototype.onRemove=function(){this.el.parentNode.removeChild(this.el)},e[0].style.display="none";var l,u,t=e.html(),n=t.match(/{{([^}]+)}}/g),o=[];return(n||[]).forEach(function(e){var t=e.replace("{{","").replace("}}","");-1==e.indexOf("::")&&-1==e.indexOf("this.")&&-1==o.indexOf(t)&&o.push(e.replace("{{","").replace("}}",""))}),l=t,u=o,function(t,n,e,o){o=o[0]||o[1];var a=m.orgAttributes(n),i=m.filter(e),r=m.getOptions(i,{scope:t}),s=m.getEvents(t,i);n[0].style.display="none",console.log("custom-marker options",r);var p=new g(r);for(var c in d(function(){t.$watch("["+u.join(",")+"]",function(){p.setContent(l,t)},!0),p.setContent(n[0].innerHTML,t);var e=n[0].firstElementChild.className;p.addClass("custom-marker"),p.addClass(e),console.log("customMarker",p,"classNames",e),r.position instanceof google.maps.LatLng||f.getGeoLocation(r.position).then(function(e){p.setPosition(e)})}),console.log("custom-marker events","events"),s)google.maps.event.addDomListener(p.el,c,s[c]);o.addObject("customMarkers",p),o.observeAttrSetObj(a,e,p),n.bind("$destroy",function(){o.deleteObject("customMarkers",p)})}}}}var m,d,a,f;e.$inject=["$timeout","$compile","Attr2MapOptions","NgMap"],angular.module("ngMap").directive("customMarker",e)}(),function(){"use strict";function u(n,e){var t=new google.maps.DirectionsService,o=e;o.travelMode=o.travelMode||"DRIVING";var a=["origin","destination","travelMode","transitOptions","unitSystem","durationInTraffic","waypoints","optimizeWaypoints","provideRouteAlternatives","avoidHighways","avoidTolls","region"];for(var i in o)-1===a.indexOf(i)&&delete o[i];function r(e){t.route(e,function(e,t){t==google.maps.DirectionsStatus.OK&&m(function(){n.setDirections(e)})})}o.waypoints&&("[]"!=o.waypoints&&""!==o.waypoints||delete o.waypoints),o.origin&&o.destination&&("current-location"==o.origin?s.getCurrentPosition().then(function(e){o.origin=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),r(o)}):"current-location"==o.destination?s.getCurrentPosition().then(function(e){o.destination=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),r(o)}):r(o))}function e(e,t,n,o){var l=e;return g=o,m=t,s=n,{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,o,n){n=n[0]||n[1];var a=l.orgAttributes(t),i=l.filter(o),r=l.getOptions(i,{scope:e}),s=l.getEvents(e,i),p=l.getAttrsToObserve(a),c=function(e,t){e.panel&&(e.panel=document.getElementById(e.panel)||document.querySelector(e.panel));var n=new google.maps.DirectionsRenderer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(r,s);n.addObject("directionsRenderers",c),p.forEach(function(e){var n;n=e,o.$observe(n,function(t){var e;"panel"==n?m(function(){var e=document.getElementById(t)||document.querySelector(t);console.log("setting ",n,"with value",e),e&&c.setPanel(e)}):r[n]!==t&&(e=l.toOptionValue(t,{key:n}),console.log("setting ",n,"with value",e),r[n]=e,u(c,r))})}),g.getMap().then(function(){u(c,r)}),t.bind("$destroy",function(){n.deleteObject("directionsRenderers",c)})}}}var g,m,s;e.$inject=["Attr2MapOptions","$timeout","NavigatorGeolocation","NgMap"],angular.module("ngMap").directive("directions",e)}(),function(){"use strict";angular.module("ngMap").directive("drawingManager",["Attr2MapOptions",function(e){var l=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a=l.filter(n),i=l.getOptions(a,{scope:e}),r=l.getControlOptions(a),s=l.getEvents(e,a),p=new google.maps.drawing.DrawingManager({drawingMode:i.drawingmode,drawingControl:i.drawingcontrol,drawingControlOptions:r.drawingControlOptions,circleOptions:i.circleoptions,markerOptions:i.markeroptions,polygonOptions:i.polygonoptions,polylineOptions:i.polylineoptions,rectangleOptions:i.rectangleoptions});for(var c in n.$observe("drawingControlOptions",function(e){p.drawingControlOptions=l.getControlOptions({drawingControlOptions:e}).drawingControlOptions,p.setDrawingMode(null),p.setMap(o.map)}),s)google.maps.event.addListener(p,c,s[c]);o.addObject("mapDrawingManager",p),t.bind("$destroy",function(){o.deleteObject("mapDrawingManager",p)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("dynamicMapsEngineLayer",["Attr2MapOptions",function(e){var p=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a=p.filter(n),i=p.getOptions(a,{scope:e}),r=p.getEvents(e,a,r),s=function(e,t){var n=new google.maps.visualization.DynamicMapsEngineLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(i,r);o.addObject("mapsEngineLayers",s)}}}])}(),function(){"use strict";angular.module("ngMap").directive("fusionTablesLayer",["Attr2MapOptions",function(e){var p=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a=p.filter(n),i=p.getOptions(a,{scope:e}),r=p.getEvents(e,a,r);console.log("fusion-tables-layer options",i,"events",r);var s=function(e,t){var n=new google.maps.FusionTablesLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(i,r);o.addObject("fusionTablesLayers",s)}}}])}(),function(){"use strict";angular.module("ngMap").directive("heatmapLayer",["Attr2MapOptions","$window",function(e,p){var c=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a=c.filter(n),i=c.getOptions(a,{scope:e});if(i.data=p[n.data]||e[n.data],!(i.data instanceof Array))throw"invalid heatmap data";i.data=new google.maps.MVCArray(i.data);var r=new google.maps.visualization.HeatmapLayer(i),s=c.getEvents(e,a);console.log("heatmap-layer options",r,"events",s),o.addObject("heatmapLayers",r)}}}])}(),function(){"use strict";function e(e,l,u,g,m,d,f){var v=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(s,e,n,p){p=p[0]||p[1],e.css("display","none");var t,o=v.orgAttributes(e),a=v.filter(n),i=v.getOptions(a,{scope:s}),r=function(e,t,n){var a;for(var o in!e.position||e.position instanceof google.maps.LatLng||delete e.position,a=new google.maps.InfoWindow(e),t)o&&google.maps.event.addListener(a,o,t[o]);var i=u(function(t){angular.isString(n)?g(n).then(function(e){t(angular.element(e).wrap("<div>").parent())},function(e){throw"info-window template request failed: "+e}):t(n)}).then(function(e){var t=e.html().trim();if(1!=angular.element(t).length)throw"info-window working as a template must have a container";a.__template=t.replace(/\s?ng-non-bindable[='"]+/,"")});return a.__open=function(t,n,o){i.then(function(){m(function(){o&&(n.anchor=o);var e=l(a.__template)(n);a.setContent(e[0]),n.$apply(),o&&o.getPosition?a.open(t,o):o&&o instanceof google.maps.LatLng?(a.open(t),a.setPosition(o)):a.open(t),a.content.parentElement.parentElement.parentElement.className="ng-map-info-window"})})},a}(i,v.getEvents(s,a),i.template||e);!i.position||i.position instanceof google.maps.LatLng||(t=i.position),t&&f.getGeoLocation(t).then(function(e){r.setPosition(e),r.__open(p.map,s,e);var t=n.geoCallback;t&&d(t)(s)}),p.addObject("infoWindows",r),p.observeAttrSetObj(o,n,r),p.showInfoWindow=p.map.showInfoWindow=p.showInfoWindow||function(e,t,n){var o="string"==typeof e?e:t,a="string"==typeof e?t:n;if("string"==typeof a)if(void 0!==p.map.markers&&void 0!==p.map.markers[a])a=p.map.markers[a];else{if(p.map.customMarkers,void 0===p.map.customMarkers[a])throw new Error("Cant open info window for id "+a+". Marker or CustomMarker is not defined");a=p.map.customMarkers[a]}var i=p.map.infoWindows[o],r=a||(this.getPosition?this:null);i.__open(p.map,s,r),p.singleInfoWindow&&(p.lastInfoWindow&&s.hideInfoWindow(p.lastInfoWindow),p.lastInfoWindow=o)},p.hideInfoWindow=p.map.hideInfoWindow=p.hideInfoWindow||function(e,t){var n="string"==typeof e?e:t;p.map.infoWindows[n].close()},s.showInfoWindow=p.map.showInfoWindow,s.hideInfoWindow=p.map.hideInfoWindow;var c=r.mapId?{id:r.mapId}:0;f.getMap(c).then(function(e){var t;r.visible&&r.__open(e,s),r.visibleOnMarker&&(t=r.visibleOnMarker,r.__open(e,s,e.markers[t]))})}}}e.$inject=["Attr2MapOptions","$compile","$q","$templateRequest","$timeout","$parse","NgMap"],angular.module("ngMap").directive("infoWindow",e)}(),function(){"use strict";angular.module("ngMap").directive("kmlLayer",["Attr2MapOptions",function(e){var c=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a=c.orgAttributes(t),i=c.filter(n),r=c.getOptions(i,{scope:e}),s=c.getEvents(e,i);console.log("kml-layer options",r,"events",s);var p=function(e,t){var n=new google.maps.KmlLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(r,s);o.addObject("kmlLayers",p),o.observeAttrSetObj(a,n,p),t.bind("$destroy",function(){o.deleteObject("kmlLayers",p)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("mapData",["Attr2MapOptions","NgMap",function(e,o){var s=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(a,e,t){var n=s.filter(t),i=s.getOptions(n,{scope:a}),r=s.getEvents(a,n,r);console.log("map-data options",i),o.getMap().then(function(e){for(var t in i){var n=i[t];"function"==typeof a[n]?e.data[t](a[n]):e.data[t](n)}for(var o in r)e.data.addListener(o,r[o])})}}}])}(),function(){"use strict";function n(e,t,n){var o,a=n.mapLazyLoadParams||n.mapLazyLoad;void 0===window.google||void 0===window.google.maps?(c.push({scope:e,element:t,savedHtml:p[c.length]}),window.lazyLoadCallback=function(){console.log("Google maps script loaded:",a),i(function(){c.forEach(function(e){e.element.html(e.savedHtml),r(e.element.contents())(e.scope)})},100)},o=document.createElement("script"),console.log("Prelinking script loaded,"+s),o.src=a+(-1<a.indexOf("?")?"&":"?")+"callback=lazyLoadCallback",document.querySelector('script[src="'+o.src+'"]')||document.body.appendChild(o)):(t.html(p),r(t.contents())(e))}function o(e,t){return t.mapLazyLoad||console.error("requires src with map-lazy-load"),p.push(e.html()),s=t.mapLazyLoad,(void 0===window.google||void 0===window.google.maps)&&(e.html(""),{pre:n})}function e(e,t){return r=e,i=t,{compile:o}}var i,r,s,p=[],c=[];e.$inject=["$compile","$timeout"],angular.module("ngMap").directive("mapLazyLoad",e)}(),function(){"use strict";angular.module("ngMap").directive("mapType",["$parse","NgMap",function(r,s){return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a,i=n.name;if(!i)throw"invalid map-type name";if(!(a=r(n.object)(e)))throw"invalid map-type object";s.getMap().then(function(e){e.mapTypes.set(i,a)}),o.addObject("mapTypes",a)}}}])}(),function(){"use strict";function e(){return{restrict:"AE",controller:"__MapController",controllerAs:"ngmap"}}angular.module("ngMap").directive("map",[e]),angular.module("ngMap").directive("ngMap",[e])}(),function(){"use strict";angular.module("ngMap").directive("mapsEngineLayer",["Attr2MapOptions",function(e){var p=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a=p.filter(n),i=p.getOptions(a,{scope:e}),r=p.getEvents(e,a,r);console.log("maps-engine-layer options",i,"events",r);var s=function(e,t){var n=new google.maps.visualization.MapsEngineLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(i,r);o.addObject("mapsEngineLayers",s)}}}])}(),function(){"use strict";function o(n,e,o,t){t=t[0]||t[1];var a,i=l.orgAttributes(e),r=l.filter(o),s=l.getOptions(r,n,{scope:n}),p=l.getEvents(n,r);console.log("marker options",s,"events",p),s.position instanceof google.maps.LatLng||(a=s.position);var c=function(e,t){var n;if(g.defaultOptions.marker)for(var o in g.defaultOptions.marker)void 0===e[o]&&(console.log("setting default marker options",o,g.defaultOptions.marker),e[o]=g.defaultOptions.marker[o]);for(var a in e.position instanceof google.maps.LatLng||(e.position=new google.maps.LatLng(0,0)),n=new google.maps.Marker(e),0<Object.keys(t).length&&console.log("markerEvents",t),t)a&&google.maps.event.addListener(n,a,t[a]);return n}(s,p);t.addObject("markers",c),a&&g.getGeoLocation(a).then(function(e){c.setPosition(e),s.centered&&c.map.setCenter(e);var t=o.geoCallback;t&&u(t)(n)}),t.observeAttrSetObj(i,o,c),e.bind("$destroy",function(){t.deleteObject("markers",c)})}function e(e,t,n){return l=e,u=t,g=n,{restrict:"E",require:["^?map","?^ngMap"],link:o}}var l,u,g;e.$inject=["Attr2MapOptions","$parse","NgMap"],angular.module("ngMap").directive("marker",e)}(),function(){"use strict";angular.module("ngMap").directive("overlayMapType",["NgMap",function(r){return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a=n.initMethod||"insertAt",i=e[n.object];r.getMap().then(function(e){var t;"insertAt"==a?(t=parseInt(n.index,10),e.overlayMapTypes.insertAt(t,i)):"push"==a&&e.overlayMapTypes.push(i)}),o.addObject("overlayMapTypes",i)}}}])}(),function(){"use strict";function e(e,l){var u=e;return{restrict:"A",require:"?ngModel",link:function(t,e,n,o){if("false"===n.placesAutoComplete)return!1;var a=u.filter(n),i=u.getOptions(a,{scope:t}),r=u.getEvents(t,a),s=new google.maps.places.Autocomplete(e[0],i);for(var p in r)google.maps.event.addListener(s,p,r[p]);function c(){l(function(){o&&o.$setViewValue(e.val())},100)}google.maps.event.addListener(s,"place_changed",c),e[0].addEventListener("change",c),n.$observe("types",function(e){var t;e&&(t=u.toOptionValue(e,{key:"types"}),s.setTypes(t))}),n.$observe("componentRestrictions",function(e){e&&s.setComponentRestrictions(t.$eval(e))})}}}e.$inject=["Attr2MapOptions","$timeout"],angular.module("ngMap").directive("placesAutoComplete",e)}(),function(){"use strict";function e(e,u,g){var m=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(n,e,o,t){t=t[0]||t[1];var a,i=m.orgAttributes(e),r=m.filter(o),s=m.getOptions(r,{scope:n}),p=m.getEvents(n,r),c=s.name;s.center instanceof google.maps.LatLng||(a=s.center);var l=function(e,t){var n=e.name;switch(delete e.name,console.log("shape",n,"options",e,"events",t),n){case"circle":e.center instanceof google.maps.LatLng||(e.center=new google.maps.LatLng(0,0)),i=new google.maps.Circle(e);break;case"polygon":i=new google.maps.Polygon(e);break;case"polyline":i=new google.maps.Polyline(e);break;case"rectangle":i=new google.maps.Rectangle(e);break;case"groundOverlay":case"image":var o=e.url,a={opacity:e.opacity,clickable:e.clickable,id:e.id},i=new google.maps.GroundOverlay(o,e.bounds,a)}for(var r in t)t[r]&&google.maps.event.addListener(i,r,t[r]);return i}(s,p);t.addObject("shapes",l),a&&"circle"==c&&g.getGeoLocation(a).then(function(e){l.setCenter(e),l.centered&&l.map.setCenter(e);var t=o.geoCallback;t&&u(t)(n)}),t.observeAttrSetObj(i,o,l),e.bind("$destroy",function(){t.deleteObject("shapes",l)})}}}e.$inject=["Attr2MapOptions","$parse","NgMap"],angular.module("ngMap").directive("shape",e)}(),function(){"use strict";function e(e,p){var c=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n){var o=c.filter(n),a=c.getOptions(o,{scope:e}),i=c.getControlOptions(o),r=angular.extend(a,i),s=c.getEvents(e,o);console.log("street-view-panorama","options",r,"events",s),p.getMap().then(function(e){var t=function(e,t,n){var o,a;for(var i in t.container&&(a=(a=document.getElementById(t.container))||document.querySelector(t.container)),a?o=new google.maps.StreetViewPanorama(a,t):(o=e.getStreetView()).setOptions(t),n)i&&google.maps.event.addListener(o,i,n[i]);return o}(e,r,s);e.setStreetView(t),t.getPosition()||t.setPosition(e.getCenter()),google.maps.event.addListener(t,"position_changed",function(){t.getPosition()!==e.getCenter()&&e.setCenter(t.getPosition())});var n=google.maps.event.addListener(e,"center_changed",function(){t.setPosition(e.getCenter()),google.maps.event.removeListener(n)})})}}}e.$inject=["Attr2MapOptions","NgMap"],angular.module("ngMap").directive("streetViewPanorama",e)}(),function(){"use strict";angular.module("ngMap").directive("trafficLayer",["Attr2MapOptions",function(e){var c=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a=c.orgAttributes(t),i=c.filter(n),r=c.getOptions(i,{scope:e}),s=c.getEvents(e,i);console.log("traffic-layer options",r,"events",s);var p=function(e,t){var n=new google.maps.TrafficLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(r,s);o.addObject("trafficLayers",p),o.observeAttrSetObj(a,n,p),t.bind("$destroy",function(){o.deleteObject("trafficLayers",p)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("transitLayer",["Attr2MapOptions",function(e){var c=e;return{restrict:"E",require:["?^map","?^ngMap"],link:function(e,t,n,o){o=o[0]||o[1];var a=c.orgAttributes(t),i=c.filter(n),r=c.getOptions(i,{scope:e}),s=c.getEvents(e,i);console.log("transit-layer options",r,"events",s);var p=function(e,t){var n=new google.maps.TransitLayer(e);for(var o in t)google.maps.event.addListener(n,o,t[o]);return n}(r,s);o.addObject("transitLayers",p),o.observeAttrSetObj(a,n,p),t.bind("$destroy",function(){o.deleteObject("transitLayers",p)})}}}])}(),function(){"use strict";var t=/([\:\-\_]+(.))/g,n=/^moz([A-Z])/;angular.module("ngMap").filter("camelCase",function(){return function(e){return e.replace(t,function(e,t,n,o){return o?n.toUpperCase():n}).replace(n,"Moz$1")}})}(),function(){"use strict";angular.module("ngMap").filter("jsonize",function(){return function(t){try{return JSON.parse(t),t}catch(e){return t.replace(/([\$\w]+)\s*:/g,function(e,t){return'"'+t+'":'}).replace(/'([^']+)'/g,function(e,t){return'"'+t+'"'})}}})}(),function(){"use strict";var isoDateRE=/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d):?(\d\d))?$/,Attr2MapOptions=function($parse,$timeout,$log,NavigatorGeolocation,GeoCoder,camelCaseFilter,jsonizeFilter){var orgAttributes=function(e){0<e.length&&(e=e[0]);for(var t={},n=0;n<e.attributes.length;n++){var o=e.attributes[n];t[o.name]=o.value}return t},getJSON=function(e){return e.match(/^[\+\-]?[0-9\.]+,[ ]*\ ?[\+\-]?[0-9\.]+$/)&&(e="["+e+"]"),JSON.parse(jsonizeFilter(e))},getLatLng=function(e){var t=e;return e[0].constructor==Array?t=e.map(function(e){return new google.maps.LatLng(e[0],e[1])}):!isNaN(parseFloat(e[0]))&&isFinite(e[0])&&(t=new google.maps.LatLng(t[0],t[1])),t},toOptionValue=function(input,options){var output;try{output=getNumber(input)}catch(err){try{var output=getJSON(input),newOptions;output instanceof Array?output=output[0].constructor==Object?output:getLatLng(output):output===Object(output)&&(newOptions=options,newOptions.doNotConverStringToNumber=!0,output=getOptions(output,newOptions))}catch(err2){if(input.match(/^[A-Z][a-zA-Z0-9]+\(.*\)$/))try{var exp="new google.maps."+input;output=eval(exp)}catch(e){output=input}else if(input.match(/^([A-Z][a-zA-Z0-9]+)\.([A-Z]+)$/))try{var matches=input.match(/^([A-Z][a-zA-Z0-9]+)\.([A-Z]+)$/);output=google.maps[matches[1]][matches[2]]}catch(e){output=input}else if(input.match(/^[A-Z]+$/))try{var capitalizedKey=options.key.charAt(0).toUpperCase()+options.key.slice(1);output=options.key.match(/temperatureUnit|windSpeedUnit|labelColor/)?(capitalizedKey=capitalizedKey.replace(/s$/,""),google.maps.weather[capitalizedKey][input]):google.maps[capitalizedKey][input]}catch(e){output=input}else if(input.match(isoDateRE))try{output=new Date(input)}catch(e){output=input}else if(input.match(/^{/)&&options.scope)try{var expr=input.replace(/{{/,"").replace(/}}/g,"");output=options.scope.$eval(expr)}catch(e){output=input}else output=input}}if(("center"==options.key||"center"==options.key)&&output instanceof Array&&(output=new google.maps.LatLng(output[0],output[1])),"bounds"==options.key&&output instanceof Array&&(output=new google.maps.LatLngBounds(output[0],output[1])),"icons"==options.key&&output instanceof Array)for(var i=0;i<output.length;i++){var el=output[i];el.icon.path.match(/^[A-Z_]+$/)&&(el.icon.path=google.maps.SymbolPath[el.icon.path])}if("icon"==options.key&&output instanceof Object)for(var key in(""+output.path).match(/^[A-Z_]+$/)&&(output.path=google.maps.SymbolPath[output.path]),output){var arr=output[key];"anchor"==key||"origin"==key||"labelOrigin"==key?output[key]=new google.maps.Point(arr[0],arr[1]):"size"!=key&&"scaledSize"!=key||(output[key]=new google.maps.Size(arr[0],arr[1]))}return output},getAttrsToObserve=function(e){var t=[];if(!e.noWatcher)for(var n in e){var o=e[n];o&&o.match(/\{\{.*\}\}/)&&t.push(camelCaseFilter(n))}return t},filter=function(e){var t={};for(var n in e)n.match(/^\$/)||n.match(/^ng[A-Z]/)||(t[n]=e[n]);return t},getOptions=function(e,t){t=t||{};var n={};for(var o in e)if(e[o]||0===e[o]){if(o.match(/^on[A-Z]/))continue;if(o.match(/ControlOptions$/))continue;"string"!=typeof e[o]||t.doNotConverStringToNumber&&e[o].match(/^[0-9]+$/)?n[o]=e[o]:n[o]=toOptionValue(e[o],{key:o,scope:t.scope})}return n},getEvents=function(i,e){function t(e){return"_"+e.toLowerCase()}function n(e){var t=e.match(/([^\(]+)\(([^\)]*)\)/),o=t[1],n=t[2].replace(/event[ ,]*/,""),a=$parse("["+n+"]");return function(e){var t=a(i);var n=o.split(".").reduce(function(e,t){return e[t]},i);n&&n.apply(this,[e].concat(t)),$timeout(function(){i.$apply()})}}var o={};for(var a in e)if(e[a]){if(!a.match(/^on[A-Z]/))continue;var r=a.replace(/^on/,"");r=(r=r.charAt(0).toLowerCase()+r.slice(1)).replace(/([A-Z])/g,t);var s=e[a];o[r]=new n(s)}return o},getControlOptions=function(e){var t={};if("object"!=typeof e)return!1;for(var n in e)if(e[n]){if(!n.match(/(.*)ControlOptions$/))continue;var o=(o=e[n].replace(/'/g,'"')).replace(/([^"]+)|("[^"]+")/g,function(e,t,n){return t?t.replace(/([a-zA-Z0-9]+?):/g,'"$1":'):n});try{var a,i,r=JSON.parse(o);for(var s in r){r[s]&&("string"==typeof(a=r[s])?a=a.toUpperCase():"mapTypeIds"===s&&(a=a.map(function(e){return e.match(/^[A-Z]+$/)?google.maps.MapTypeId[e.toUpperCase()]:e})),"style"===s?(i=(n.charAt(0).toUpperCase()+n.slice(1)).replace(/Options$/,"")+"Style",r[s]=google.maps[i][a]):r[s]="position"===s?google.maps.ControlPosition[a]:a)}t[n]=r}catch(e){console.error("invald option for",n,o,e,e.stack)}}return t};return{filter:filter,getOptions:getOptions,getEvents:getEvents,getControlOptions:getControlOptions,toOptionValue:toOptionValue,getAttrsToObserve:getAttrsToObserve,orgAttributes:orgAttributes}};Attr2MapOptions.$inject=["$parse","$timeout","$log","NavigatorGeolocation","GeoCoder","camelCaseFilter","jsonizeFilter"],angular.module("ngMap").service("Attr2MapOptions",Attr2MapOptions)}(),function(){"use strict";function t(e){var n=o.defer();return(new google.maps.Geocoder).geocode(e,function(e,t){t==google.maps.GeocoderStatus.OK?n.resolve(e):n.reject(t)}),n.promise}function e(e){return o=e,{geocode:t}}var o;e.$inject=["$q"],angular.module("ngMap").service("GeoCoder",e)}(),function(){"use strict";function t(e){var t=n.defer();return navigator.geolocation?(void 0===e?e={timeout:5e3}:void 0===e.timeout&&(e.timeout=5e3),navigator.geolocation.getCurrentPosition(function(e){t.resolve(e)},function(e){console.error(e),t.reject(e)},e)):t.reject("Browser Geolocation service failed."),t.promise}function e(e){return n=e,{getCurrentPosition:t}}var n;e.$inject=["$q"],angular.module("ngMap").service("NavigatorGeolocation",e)}(),function(){"use strict";function o(e){var t=function(e,t){for(var n,o=0;o<c.length;o++){var a=c[o];if(a.id==t&&!a.inUse){var i=a.getDiv();e.appendChild(i),n=a;break}}return n}(e,e.id)||function(e){for(var t,n=0;n<c.length;n++){var o=c[n];if(!o.id&&!o.inUse){var a=o.getDiv();e.appendChild(a),t=o;break}}return t}(e);return t?p(function(){google.maps.event.trigger(t,"idle")},100):t=function(e){var t=s.createElement("div");t.style.width="100%",t.style.height="100%",e.appendChild(t);var n=new r.google.maps.Map(t,{});return c.push(n),n}(e),t.inUse=!0,t}function a(e){e.inUse=!1}function i(){for(var e=0;e<c.length;e++)c[e]=null;c=[]}function e(e,t,n){return s=e[0],r=t,p=n,{mapInstances:c,resetMapInstances:i,getMapInstance:o,returnMapInstance:a}}var r,s,p,c=[];e.$inject=["$document","$window","$timeout"],angular.module("ngMap").factory("NgMapPool",e)}(),function(){"use strict";function t(e,t){var n;return e.currentStyle?n=e.currentStyle[t]:f.getComputedStyle&&(n=v.defaultView.getComputedStyle(e,null).getPropertyValue(t)),n}function p(e){var t=i[e||0];if(!(t.map instanceof google.maps.Map))return t.initializeMap(),t.map;console.error("map is already instialized")}function c(n){n=(n="object"==typeof n?n.id:n)||0;var o=y.defer(),a=2e3;return function e(t){i[n]?o.resolve(i[n].map):a<t?o.reject("could not find map"):f.setTimeout(function(){e(t+100)},100)}(0),o.promise}function l(e){var t;e.map&&(t=Object.keys(i).length,i[e.map.id||t]=e)}function u(t){var e=Object.keys(i).length-1,n=t.map.id||e;if(t.map){for(var o in t.eventListeners){console.log("clearing map events",o);var a=t.eventListeners[o];google.maps.event.removeListener(a)}t.map.controls&&t.map.controls.forEach(function(e){e.clear()})}t.map.heatmapLayers&&Object.keys(t.map.heatmapLayers).forEach(function(e){t.deleteObject("heatmapLayers",t.map.heatmapLayers[e])}),delete i[n]}function g(e,t){var a=y.defer();return!e||e.match(/^current/i)?h.getCurrentPosition(t).then(function(e){var t=e.coords.latitude,n=e.coords.longitude,o=new google.maps.LatLng(t,n);a.resolve(o)},function(e){a.reject(e)}):b.geocode({address:e}).then(function(e){a.resolve(e[0].geometry.location)},function(e){a.reject(e)}),a.promise}function m(o,a){return console.log("observing",o,"on object",a),function(e){var t,n;e&&(t=O("set-"+o),n=M.toOptionValue(e,{key:o}),a[t]&&(console.log("observing",o,"and setting",n),o.match(/center|position/)&&"string"==typeof n?g(n).then(function(e){a[t](e)}):a[t](n)))}}function d(e){"true"==e.getAttribute("default-style")?(e.style.display="block",e.style.height="300px"):("block"!=t(e,"display")&&(e.style.display="block"),t(e,"height").match(/^(0|auto)/)&&(e.style.height="300px"))}var f,v,y,h,M,b,O,i={};angular.module("ngMap").provider("NgMap",function(){var s={};this.setDefaultOptions=function(e){s=e};function e(e,t,n,o,a,i,r){return f=e,v=t[0],y=n,h=o,M=a,b=i,O=r,{defaultOptions:s,addMap:l,deleteMap:u,getMap:c,initMap:p,setStyle:d,getGeoLocation:g,observeAndSet:m}}e.$inject=["$window","$document","$q","NavigatorGeolocation","Attr2MapOptions","GeoCoder","camelCaseFilter"],this.$get=e})}(),function(){"use strict";function t(e,t){t=t||e.getCenter();var n=o.defer();return(new google.maps.StreetViewService).getPanoramaByLocation(t||e.getCenter,100,function(e,t){t===google.maps.StreetViewStatus.OK?n.resolve(e.location.pano):n.resolve(!1)}),n.promise}function n(e,t){new google.maps.StreetViewPanorama(e.getDiv(),{enableCloseButton:!0}).setPano(t)}function e(e){return o=e,{getPanorama:t,setPanorama:n}}var o;e.$inject=["$q"],angular.module("ngMap").service("StreetView",e)}();