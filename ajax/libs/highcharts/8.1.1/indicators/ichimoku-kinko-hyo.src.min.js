"use strict";!function(n){"object"==typeof module&&module.exports?module.exports=n.default=n:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return n(o),n.Highcharts=o,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){var n=o?o._modules:{};function t(o,n,t,e){o.hasOwnProperty(n)||(o[n]=e.apply(null,t))}t(n,"indicators/ichimoku-kinko-hyo.src.js",[n["parts/Globals.js"],n["parts/Color.js"],n["parts/Utilities.js"]],function(i,o,n){var b,t=o.parse,M=n.defined,j=n.isArray,w=n.merge,D=n.objectEach,e=n.seriesType,O=i.seriesTypes.sma;function G(o){return{high:o.reduce(function(o,n){return Math.max(o,n[1])},-1/0),low:o.reduce(function(o,n){return Math.min(o,n[2])},1/0)}}function K(o,n,t,e){if(o&&n&&t&&e){var i=n.plotX-o.plotX,p=n.plotY-o.plotY,a=e.plotX-t.plotX,l=e.plotY-t.plotY,s=o.plotX-t.plotX,r=o.plotY-t.plotY,h=(-p*s+i*r)/(-a*p+i*l),u=(a*r-l*s)/(-a*p+i*l);if(0<=h&&h<=1&&0<=u&&u<=1)return{plotX:o.plotX+u*i,plotY:o.plotY+u*p}}return!1}function T(o){var n=o.indicator;n.points=o.points,n.nextPoints=o.nextPoints,n.color=o.color,n.options=w(o.options.senkouSpan.styles,o.gap),n.graph=o.graph,n.fillGraph=!0,O.prototype.drawGraph.call(n)}e("ikh","sma",{params:{period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!(i.approximations["ichimoku-averages"]=function(){var t,e=[];return[].forEach.call(arguments,function(o,n){e.push(i.approximations.average(o)),t=!t&&void 0===e[n]}),t?void 0:e})},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}},{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"],init:function(){O.prototype.init.apply(this,arguments),this.options=w({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:t(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:t(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:t(this.color).setOpacity(.2).get()}}},this.options)},toYData:function(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]},translate:function(){var t=this;O.prototype.translate.apply(t),t.points.forEach(function(n){t.pointArrayMap.forEach(function(o){M(n[o])&&(n["plot"+o]=t.yAxis.toPixels(n[o],!0),n.plotY=n["plot"+o],n.tooltipPos=[n.plotX,n["plot"+o]],n.isNull=!1)})})},drawGraph:function(){var o,n,t,e,i,p,a,l,s,r,h,u,c,k,f,g,S=this,d=S.points,y=d.length,m=S.options,v=S.graph,A=S.color,x={options:{gapSize:m.gapSize}},Y=S.pointArrayMap.length,C=[[],[],[],[],[],[]],P={tenkanLine:C[0],kijunLine:C[1],chikouLine:C[2],senkouSpanA:C[3],senkouSpanB:C[4],senkouSpan:C[5]},B=[],N=S.options.senkouSpan,b=N.color||N.styles.fill,j=N.negativeColor,G=[[],[]],X=[[],[]],E=0;for(S.ikhMap=P;y--;){for(n=d[y],t=0;t<Y;t++)o=S.pointArrayMap[t],M(n[o])&&C[t].push({plotX:n.plotX,plotY:n["plot"+o],isNull:!1});j&&y!==d.length-1&&(k=P.senkouSpanB.length-1,g={plotX:(f=K(P.senkouSpanA[k-1],P.senkouSpanA[k],P.senkouSpanB[k-1],P.senkouSpanB[k])).plotX,plotY:f.plotY,isNull:!1,intersectPoint:!0},f&&(P.senkouSpanA.splice(k,0,g),P.senkouSpanB.splice(k,0,g),B.push(k)))}if(D(P,function(o,n){m[n]&&"senkouSpan"!==n&&(S.points=C[E],S.options=w(m[n].styles,x),S.graph=S["graph"+n],S.fillGraph=!1,S.color=A,O.prototype.drawGraph.call(S),S["graph"+n]=S.graph),E++}),S.graphCollection&&S.graphCollection.forEach(function(o){S[o].destroy(),delete S[o]}),S.graphCollection=[],j&&P.senkouSpanA[0]&&P.senkouSpanB[0]){for(B.unshift(0),B.push(P.senkouSpanA.length-1),u=0;u<B.length-1;u++)if(e=B[u],i=B[u+1],p=P.senkouSpanB.slice(e,i+1),a=P.senkouSpanA.slice(e,i+1),1<=Math.floor(p.length/2)){var L=Math.floor(p.length/2);if(p[L].plotY===a[L].plotY){for(c=s=l=0;c<p.length;c++)l+=p[c].plotY,s+=a[c].plotY;G[h=s<l?0:1]=G[h].concat(p),X[h]=X[h].concat(a)}else h=p[L].plotY>a[L].plotY?0:1,G[h]=G[h].concat(p),X[h]=X[h].concat(a)}else h=p[0].plotY>a[0].plotY?0:1,G[h]=G[h].concat(p),X[h]=X[h].concat(a);["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,n){G[n].length&&X[n].length&&(r=0===n?b:j,T({indicator:S,points:G[n],nextPoints:X[n],color:r,options:m,gap:x,graph:S[o]}),S[o]=S.graph,S.graphCollection.push(o))})}else T({indicator:S,points:P.senkouSpanB,nextPoints:P.senkouSpanA,color:b,options:m,gap:x,graph:S.graphsenkouSpan}),S.graphsenkouSpan=S.graph;delete S.nextPoints,delete S.fillGraph,S.points=d,S.options=m,S.graph=v},getGraphPath:function(o){var n,t=this,e=[],i=[];if(o=o||this.points,t.fillGraph&&t.nextPoints){(n=O.prototype.getGraphPath.call(t,t.nextPoints))[0][0]="L",e=O.prototype.getGraphPath.call(t,o);for(var p=(i=n.slice(0,e.length)).length-1;0<=p;p--)e.push(i[p])}else e=O.prototype.getGraphPath.apply(t,arguments);return e},getValues:function(o,n){var t,e,i,p,a,l,s,r,h,u,c,k,f,g,S,d,y=n.period,m=n.periodTenkan,v=n.periodSenkouSpanB,A=o.xData,x=o.yData,Y=o.xAxis,C=x&&x.length||0,P=(Y.series.forEach(function(o){if(o.xData)for(S=o.xData,f=o.xIncrement?1:S.length-1,d=f;0<d;d--)g=S[d]-S[d-1],(k===b||g<k)&&(k=g)}),k),B=[],N=[];if(!(A.length<=y)&&j(x[0])&&4===x[0].length){for(t=A[0]-y*P,l=0;l<y;l++)N.push(t+l*P);for(l=0;l<C;l++)m<=l&&(s=((i=G(x.slice(l-m,l))).high+i.low)/2),y<=l&&(u=(s+(r=((p=G(x.slice(l-y,l))).high+p.low)/2))/2),v<=l&&(c=((a=G(x.slice(l-v,l))).high+a.low)/2),h=x[l][3],e=A[l],B[l]===b&&(B[l]=[]),B[l+y]===b&&(B[l+y]=[]),B[l+y][0]=s,B[l+y][1]=r,B[l+y][2]=b,B[l][2]=h,l<=y&&(B[l+y][3]=b,B[l+y][4]=b),B[l+2*y]===b&&(B[l+2*y]=[]),B[l+2*y][3]=u,B[l+2*y][4]=c,N.push(e);for(l=1;l<=y;l++)N.push(e+l*P);return{values:B,xData:N,yData:B}}}})}),t(n,"masters/indicators/ichimoku-kinko-hyo.src.js",[],function(){})});