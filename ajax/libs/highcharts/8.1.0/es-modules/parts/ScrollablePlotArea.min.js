"use strict";import H from"./Globals.js";import U from"./Utilities.js";var addEvent=U.addEvent,createElement=U.createElement,pick=U.pick,stop=U.stop,Chart=H.Chart;addEvent(Chart,"afterSetChartSize",function(t){var i,e,s,h=this.options.chart.scrollablePlotArea,l=h&&h.minWidth,r=h&&h.minHeight;this.renderer.forExport||(l?(this.scrollablePixelsX=i=Math.max(0,l-this.chartWidth),i&&(this.plotWidth+=i,this.inverted?(this.clipBox.height+=i,this.plotBox.height+=i):(this.clipBox.width+=i,this.plotBox.width+=i),s={1:{name:"right",value:i}})):r&&(this.scrollablePixelsY=e=Math.max(0,r-this.chartHeight),e&&(this.plotHeight+=e,this.inverted?(this.clipBox.width+=e,this.plotBox.width+=e):(this.clipBox.height+=e,this.plotBox.height+=e),s={2:{name:"bottom",value:e}})),s&&!t.skipAxes&&this.axes.forEach(function(t){s[t.side]?t.getPlotLinePath=function(){var i,e=s[t.side].name,h=s[t.side].value,l=this[e];return this[e]=l-h,i=H.Axis.prototype.getPlotLinePath.apply(this,arguments),this[e]=l,i}:(t.setAxisSize(),t.setAxisTranslation())}))}),addEvent(Chart,"render",function(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()}),Chart.prototype.setUpScrolling=function(){var t=this,i={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(i.overflowX="auto"),this.scrollablePixelsY&&(i.overflowY="auto"),this.scrollingContainer=createElement("div",{className:"highcharts-scrolling"},i,this.renderTo),addEvent(this.scrollingContainer,"scroll",function(){t.pointer&&delete t.pointer.chartPosition}),this.innerContainer=createElement("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null},Chart.prototype.moveFixedElements=function(){var t,i=this.container,e=this.fixedRenderer,s=[".highcharts-contextbutton",".highcharts-credits",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];this.scrollablePixelsX&&!this.inverted?t=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&!this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(t=".highcharts-yaxis"),s.push(t,t+"-labels"),s.forEach(function(t){[].forEach.call(i.querySelectorAll(t),function(t){(t.namespaceURI===e.SVG_NS?e.box:e.box.parentNode).appendChild(t),t.style.pointerEvents="auto"})})},Chart.prototype.applyFixed=function(){var t,i,e,s,h=!this.fixedDiv,l=this.options.chart.scrollablePlotArea;h?(this.fixedDiv=createElement("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:2},null,!0),this.renderTo.insertBefore(this.fixedDiv,this.renderTo.firstChild),this.renderTo.style.overflow="visible",this.fixedRenderer=i=new H.Renderer(this.fixedDiv,this.chartWidth,this.chartHeight,null===(t=this.options.chart)||void 0===t?void 0:t.style),this.scrollableMask=i.path().attr({fill:this.options.chart.backgroundColor||"#fff","fill-opacity":pick(l.opacity,.85),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),this.moveFixedElements(),addEvent(this,"afterShowResetZoom",this.moveFixedElements),addEvent(this,"afterLayOutTitles",this.moveFixedElements)):this.fixedRenderer.setSize(this.chartWidth,this.chartHeight),e=this.chartWidth+(this.scrollablePixelsX||0),s=this.chartHeight+(this.scrollablePixelsY||0),stop(this.container),this.container.style.width=e+"px",this.container.style.height=s+"px",this.renderer.boxWrapper.attr({width:e,height:s,viewBox:[0,0,e,s].join(" ")}),this.chartBackground.attr({width:e,height:s}),this.scrollingContainer.style.height=this.chartHeight+"px",h&&(l.scrollPositionX&&(this.scrollingContainer.scrollLeft=this.scrollablePixelsX*l.scrollPositionX),l.scrollPositionY&&(this.scrollingContainer.scrollTop=this.scrollablePixelsY*l.scrollPositionY));var r,o=this.axisOffset,a=this.plotTop-o[0]-1,n=this.plotLeft-o[3]-1,c=this.plotTop+this.plotHeight+o[2]+1,d=this.plotLeft+this.plotWidth+o[1]+1,p=this.plotLeft+this.plotWidth-(this.scrollablePixelsX||0),x=this.plotTop+this.plotHeight-(this.scrollablePixelsY||0);r=this.scrollablePixelsX?[["M",0,a],["L",this.plotLeft-1,a],["L",this.plotLeft-1,c],["L",0,c],["Z"],["M",p,a],["L",this.chartWidth,a],["L",this.chartWidth,c],["L",p,c],["Z"]]:this.scrollablePixelsY?[["M",n,0],["L",n,this.plotTop-1],["L",d,this.plotTop-1],["L",d,0],["Z"],["M",n,x],["L",n,this.chartHeight],["L",d,this.chartHeight],["L",d,x],["Z"]]:[["M",0,0]],"adjustHeight"!==this.redrawTrigger&&this.scrollableMask.attr({d:r})};