var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function isPushStateAvailable(){return!("undefined"==typeof window||!window.history||!window.history.pushState)}function Navigo(e,t,o){this.root=null,this._routes=[],this._useHash=t,this._hash=void 0===o?"#":o,this._paused=!1,this._destroyed=!1,this._lastRouteResolved=null,this._notFoundHandler=null,this._defaultHandler=null,this._usePushState=!t&&isPushStateAvailable(),this._onLocationChange=this._onLocationChange.bind(this),this._genericHooks=null,this._historyAPIUpdateMethod="pushState",e?this.root=t?e.replace(/\/$/,"/"+this._hash):e.replace(/\/$/,""):t&&(this.root=this._cLoc().split(this._hash)[0].replace(/\/$/,"/"+this._hash)),this._listen(),this.updatePageLinks()}function clean(e){return e instanceof RegExp?e:e.replace(/\/+$/,"").replace(/^\/+/,"^/")}function regExpResultToParams(e,t){return 0===t.length?null:e?e.slice(1,e.length).reduce(function(e,o,n){return null===e&&(e={}),e[t[n]]=decodeURIComponent(o),e},null):null}function replaceDynamicURLParts(e){var t=[];return{regexp:e instanceof RegExp?e:new RegExp(e.replace(Navigo.PARAMETER_REGEXP,function(e,o,n){return t.push(n),Navigo.REPLACE_VARIABLE_REGEXP}).replace(Navigo.WILDCARD_REGEXP,Navigo.REPLACE_WILDCARD)+Navigo.FOLLOWED_BY_SLASH_REGEXP,Navigo.MATCH_REGEXP_FLAGS),paramNames:t}}function getUrlDepth(e){return e.replace(/\/$/,"").split("/").length}function compareUrlDepth(e,t){return getUrlDepth(t)-getUrlDepth(e)}function findMatchedRoutes(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(function(t){var o=replaceDynamicURLParts(clean(t.route)),n=o.regexp,i=o.paramNames,s=e.replace(/^\/+/,"/").match(n),a=regExpResultToParams(s,i);return!!s&&{match:s,route:t,params:a}}).filter(function(e){return e})}function match(e,t){return findMatchedRoutes(e,t)[0]||!1}function root(e,t){var o=t.map(function(t){return""===t.route||"*"===t.route?e:e.split(new RegExp(t.route+"($|/)"))[0]}),n=clean(e);return o.length>1?o.reduce(function(e,t){return e.length>t.length&&(e=t),e},o[0]):1===o.length?o[0]:n}function isHashChangeAPIAvailable(){return"undefined"!=typeof window&&"onhashchange"in window}function extractGETParameters(e){return e.split(/\?(.*)?$/).slice(1).join("")}function getOnlyURL(e,t,o){var n,i=function(e){return e.split(/\?(.*)?$/)[0]};return void 0===o&&(o="#"),isPushStateAvailable()&&!t?i(e).split(o)[0]:(n=e.split(o)).length>1?i(n[1]):i(n[0])}function manageHooks(e,t,o){if(t&&"object"===(void 0===t?"undefined":_typeof(t))){if(t.before)return void t.before(function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e(),t.after&&t.after(o))},o);if(t.after)return e(),void(t.after&&t.after(o))}e()}function isHashedRoot(e,t,o){if(isPushStateAvailable()&&!t)return!1;if(!e.match(o))return!1;var n=e.split(o);return n.length<2||""===n[1]}Navigo.prototype={helpers:{match:match,root:root,clean:clean,getOnlyURL:getOnlyURL},navigate:function(e,t){var o;return e=e||"",this._usePushState?(o=(o=(t?"":this._getRoot()+"/")+e.replace(/^\/+/,"/")).replace(/([^:])(\/{2,})/g,"$1/"),history[this._historyAPIUpdateMethod]({},"",o),this.resolve()):"undefined"!=typeof window&&(e=e.replace(new RegExp("^"+this._hash),""),window.location.href=window.location.href.replace(/#$/,"").replace(new RegExp(this._hash+".*$"),"")+this._hash+e),this},on:function(){for(var e=this,t=arguments.length,o=Array(t),n=0;n<t;n++)o[n]=arguments[n];if("function"==typeof o[0])this._defaultHandler={handler:o[0],hooks:o[1]};else if(o.length>=2)if("/"===o[0]){var i=o[1];"object"===_typeof(o[1])&&(i=o[1].uses),this._defaultHandler={handler:i,hooks:o[2]}}else this._add(o[0],o[1],o[2]);else if("object"===_typeof(o[0])){Object.keys(o[0]).sort(compareUrlDepth).forEach(function(t){e.on(t,o[0][t])})}return this},off:function(e){return null!==this._defaultHandler&&e===this._defaultHandler.handler?this._defaultHandler=null:null!==this._notFoundHandler&&e===this._notFoundHandler.handler&&(this._notFoundHandler=null),this._routes=this._routes.reduce(function(t,o){return o.handler!==e&&t.push(o),t},[]),this},notFound:function(e,t){return this._notFoundHandler={handler:e,hooks:t},this},resolve:function(e){var t,o,n=this,i=(e||this._cLoc()).replace(this._getRoot(),"");this._useHash&&(i=i.replace(new RegExp("^/"+this._hash),"/"));var s=extractGETParameters(e||this._cLoc()),a=getOnlyURL(i,this._useHash,this._hash);return!this._paused&&(this._lastRouteResolved&&a===this._lastRouteResolved.url&&s===this._lastRouteResolved.query?(this._lastRouteResolved.hooks&&this._lastRouteResolved.hooks.already&&this._lastRouteResolved.hooks.already(this._lastRouteResolved.params),!1):(o=match(a,this._routes))?(this._callLeave(),this._lastRouteResolved={url:a,query:s,hooks:o.route.hooks,params:o.params,name:o.route.name},t=o.route.handler,manageHooks(function(){manageHooks(function(){o.route.route instanceof RegExp?t.apply(void 0,o.match.slice(1,o.match.length)):t(o.params,s)},o.route.hooks,o.params,n._genericHooks)},this._genericHooks,o.params),o):this._defaultHandler&&(""===a||"/"===a||a===this._hash||isHashedRoot(a,this._useHash,this._hash))?(manageHooks(function(){manageHooks(function(){n._callLeave(),n._lastRouteResolved={url:a,query:s,hooks:n._defaultHandler.hooks},n._defaultHandler.handler(s)},n._defaultHandler.hooks)},this._genericHooks),!0):(this._notFoundHandler&&manageHooks(function(){manageHooks(function(){n._callLeave(),n._lastRouteResolved={url:a,query:s,hooks:n._notFoundHandler.hooks},n._notFoundHandler.handler(s)},n._notFoundHandler.hooks)},this._genericHooks),!1))},destroy:function(){this._routes=[],this._destroyed=!0,this._lastRouteResolved=null,this._genericHooks=null,clearTimeout(this._listeningInterval),"undefined"!=typeof window&&(window.removeEventListener("popstate",this._onLocationChange),window.removeEventListener("hashchange",this._onLocationChange))},updatePageLinks:function(){var e=this;"undefined"!=typeof document&&this._findLinks().forEach(function(t){t.hasListenerAttached||(t.addEventListener("click",function(o){var n=e.getLinkPath(t);e._destroyed||(o.preventDefault(),e.navigate(n.replace(/\/+$/,"").replace(/^\/+/,"/")))}),t.hasListenerAttached=!0)})},generate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this._routes.reduce(function(o,n){var i;if(n.name===e)for(i in o=n.route,t)o=o.toString().replace(":"+i,t[i]);return o},"");return this._useHash?this._hash+o:o},link:function(e){return this._getRoot()+e},pause:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._paused=e,this._historyAPIUpdateMethod=e?"replaceState":"pushState"},resume:function(){this.pause(!1)},historyAPIUpdateMethod:function(e){return void 0===e?this._historyAPIUpdateMethod:(this._historyAPIUpdateMethod=e,e)},disableIfAPINotAvailable:function(){isPushStateAvailable()||this.destroy()},lastRouteResolved:function(){return this._lastRouteResolved},getLinkPath:function(e){return e.getAttribute("href")},hooks:function(e){this._genericHooks=e},_add:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"string"==typeof e&&(e=encodeURI(e)),this._routes.push("object"===(void 0===t?"undefined":_typeof(t))?{route:e,handler:t.uses,name:t.as,hooks:o||t.hooks}:{route:e,handler:t,hooks:o}),this._add},_getRoot:function(){return null!==this.root?this.root:(this.root=root(this._cLoc().split("?")[0],this._routes),this.root)},_listen:function(){var e=this;if(this._usePushState)window.addEventListener("popstate",this._onLocationChange);else if(isHashChangeAPIAvailable())window.addEventListener("hashchange",this._onLocationChange);else{var t=this._cLoc(),o=void 0,n=void 0;(n=function(){o=e._cLoc(),t!==o&&(t=o,e.resolve()),e._listeningInterval=setTimeout(n,200)})()}},_cLoc:function(){return"undefined"!=typeof window?void 0!==window.__NAVIGO_WINDOW_LOCATION_MOCK__?window.__NAVIGO_WINDOW_LOCATION_MOCK__:clean(window.location.href):""},_findLinks:function(){return[].slice.call(document.querySelectorAll("[data-navigo]"))},_onLocationChange:function(){this.resolve()},_callLeave:function(){var e=this._lastRouteResolved;e&&e.hooks&&e.hooks.leave&&e.hooks.leave(e.params)}},Navigo.PARAMETER_REGEXP=/([:*])(\w+)/g,Navigo.WILDCARD_REGEXP=/\*/g,Navigo.REPLACE_VARIABLE_REGEXP="([^/]+)",Navigo.REPLACE_WILDCARD="(?:.*)",Navigo.FOLLOWED_BY_SLASH_REGEXP="(?:/$|$)",Navigo.MATCH_REGEXP_FLAGS="";export default Navigo;