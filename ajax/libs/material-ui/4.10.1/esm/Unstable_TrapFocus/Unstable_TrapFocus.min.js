import*as React from"react";import*as ReactDOM from"react-dom";import PropTypes from"prop-types";import ownerDocument from"../utils/ownerDocument";import useForkRef from"../utils/useForkRef";import{exactProp}from"@material-ui/utils";function Unstable_TrapFocus(e){var t=e.children,r=e.disableAutoFocus,n=void 0!==r&&r,o=e.disableEnforceFocus,c=void 0!==o&&o,s=e.disableRestoreFocus,u=void 0!==s&&s,a=e.getDoc,i=e.isEnabled,l=e.open,f=React.useRef(),p=React.useRef(null),d=React.useRef(null),R=React.useRef(),m=React.useRef(null),b=React.useCallback(function(e){m.current=ReactDOM.findDOMNode(e)},[]),v=useForkRef(t.ref,b),E=React.useRef();return React.useEffect(function(){E.current=l},[l]),!E.current&&l&&"undefined"!=typeof window&&(R.current=a().activeElement),React.useEffect(function(){if(l){var e=ownerDocument(m.current);n||!m.current||m.current.contains(e.activeElement)||(m.current.hasAttribute("tabIndex")||("production"!==process.env.NODE_ENV&&console.error(["Material-UI: The modal content node does not accept focus.",'For the benefit of assistive technologies, the tabIndex of the node is being set to "-1".'].join("\n")),m.current.setAttribute("tabIndex",-1)),m.current.focus());var t=function(){e.hasFocus()&&!c&&i()&&!f.current?m.current&&!m.current.contains(e.activeElement)&&m.current.focus():f.current=!1},r=function(t){!c&&i()&&9===t.keyCode&&e.activeElement===m.current&&(f.current=!0,t.shiftKey?d.current.focus():p.current.focus())};e.addEventListener("focus",t,!0),e.addEventListener("keydown",r,!0);var o=setInterval(function(){t()},50);return function(){clearInterval(o),e.removeEventListener("focus",t,!0),e.removeEventListener("keydown",r,!0),u||(R.current&&R.current.focus&&R.current.focus(),R.current=null)}}},[n,c,u,i,l]),React.createElement(React.Fragment,null,React.createElement("div",{tabIndex:0,ref:p,"data-test":"sentinelStart"}),React.cloneElement(t,{ref:v}),React.createElement("div",{tabIndex:0,ref:d,"data-test":"sentinelEnd"}))}"production"!==process.env.NODE_ENV&&(Unstable_TrapFocus.propTypes={children:PropTypes.node,disableAutoFocus:PropTypes.bool,disableEnforceFocus:PropTypes.bool,disableRestoreFocus:PropTypes.bool,getDoc:PropTypes.func.isRequired,isEnabled:PropTypes.func.isRequired,open:PropTypes.bool.isRequired}),"production"!==process.env.NODE_ENV&&(Unstable_TrapFocus.propTypes=exactProp(Unstable_TrapFocus.propTypes));export default Unstable_TrapFocus;