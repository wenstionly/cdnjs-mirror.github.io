angular.module("materialCalendar",["ngMaterial","ngSanitize"]),angular.module("materialCalendar").constant("config",{version:"0.2.9",debug:-1<document.domain.indexOf("localhost")}),angular.module("materialCalendar").config(["config","$logProvider","$compileProvider",function(t,a,e){t.debug&&(a.debugEnabled(!1),e.debugInfoEnabled(!1))}]),angular.module("materialCalendar").service("Calendar",[function(){return function(t,a,e){var n=new Date;this.getNumDays=function(){return new Date(this.start.getYear(),this.start.getMonth(),0).getDate()},this.setWeekStartsOn=function(t){var a=parseInt(t||0,10);return!isNaN(a)&&0<=a&&a<=6?this.weekStartsOn=a:this.weekStartsOn=0,this.weekStartsOn},this.options=angular.isObject(e)?e:{},this.year=n.getFullYear(),this.month=n.getMonth(),this.weeks=[],this.weekStartsOn=this.setWeekStartsOn(this.options.weekStartsOn),this.getFirstDayOfCalendar=function(){for(var t=this.start,a=angular.copy(t);a.getDay()!=this.weekStartsOn;){var e=a.getDate();a.setDate(e-1)}return a},this.next=function(){this.start.getMonth()<11?this.init(this.start.getFullYear(),this.start.getMonth()+1):this.init(this.start.getFullYear()+1,0)},this.prev=function(){this.month?this.init(this.start.getFullYear(),this.start.getMonth()-1):this.init(this.start.getFullYear()-1,11)},this.init=function(t,a){var e=new Date;this.year=angular.isDefined(t)?t:e.getFullYear(),this.month=angular.isDefined(a)?a:e.getMonth();var n=[31,28,31,30,31,30,31,31,30,31,30,31][this.month];1==this.month&&(this.year%4==0&&this.year%100!=0||this.year%400==0)&&(n=29),this.start=new Date(this.year,this.month,1);for(var o=angular.copy(this.start);o.getDay()!=this.weekStartsOn;)o.setDate(o.getDate()-1),n++;for(;n%7!=0;)n++;this.weeks=[];for(var r=0;r<n;++r)r%7==0&&this.weeks.push([]),this.weeks[this.weeks.length-1].push(angular.copy(o)),o.setDate(o.getDate()+1)},this.init(t,a)}}]),angular.module("materialCalendar").directive("calendarMd",["$compile","$timeout","$parse","$http","$q","$filter","$log","Calendar",function(p,t,f,v,b,a,w,k){var x;return{restrict:"E",scope:{ngModel:"=?",template:"&",templateUrl:"=?",onDayClick:"=?",onPrevMonth:"=?",onNextMonth:"=?",calendarDirection:"=?",dayContent:"&?",timezone:"=?",titleFormat:"=?",dayFormat:"=?",dayLabelFormat:"=?",dayLabelTooltipFormat:"=?",dayTooltipFormat:"=?",weekStartsOn:"=?",tooltips:"&?"},link:function(n,a,o){var t,e;x||(t=document.getElementsByTagName("head")[0],(e=document.createElement("style")).type="text/css",e.id="calendarMdCss",e.innerHTML="calendar-md md-content>md-content.agenda>*>* :not(:first-child),calendar-md md-content>md-content.calendar>:not(:first-child)>* :last-child{overflow:hidden;text-overflow:ellipsis}calendar-md{display:block;max-height:100%}calendar-md md-content>md-content{border:1px solid rgba(0,0,0,.12)}calendar-md md-content>md-content.agenda>*>*{border-bottom:1px solid rgba(0,0,0,.12)}calendar-md md-content>md-content.agenda>*>* :first-child{padding:12px;width:200px;text-align:right;color:rgba(0,0,0,.75);font-weight:100;overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}calendar-md md-content>md-content.calendar>:first-child{background:rgba(0,0,0,.02);border-bottom:1px solid rgba(0,0,0,.12);margin-right:0;min-height:36px}calendar-md md-content>md-content.calendar>:not(:first-child)>*{border-bottom:1px solid rgba(0,0,0,.12);border-right:1px solid rgba(0,0,0,.12);cursor:pointer}calendar-md md-content>md-content.calendar>:not(:first-child)>:hover{background:rgba(0,0,0,.04)}calendar-md md-content>md-content.calendar>:not(:first-child)>.disabled{color:rgba(0,0,0,.3);pointer-events:none;cursor:auto}calendar-md md-content>md-content.calendar>:not(:first-child)>.active{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);background:rgba(0,0,0,.02)}calendar-md md-content>md-content.calendar>:not(:first-child)>* :first-child{padding:0}",t.insertBefore(e,t.firstChild),x=!0);var r=new Date,i=parseInt(o.startMonth||r.getMonth()),l=parseInt(o.startYear||r.getFullYear());n.columnWeekLayout="column",n.weekLayout="row",n.timezone=n.timezone||null,o.ngModel?(n.active=n.$parent.$eval(o.ngModel),o.ngModel&&n.$watch("$parent."+o.ngModel,function(t){n.active=t})):n.active=null,n.titleFormat=n.titleFormat||"MMMM yyyy",n.dayLabelFormat=n.dayLabelFormat||"EEE",n.dayLabelTooltipFormat=n.dayLabelTooltipFormat||"EEEE",n.dayFormat=n.dayFormat||"d",n.dayTooltipFormat=n.dayTooltipFormat||"fullDate",n.sameMonth=function(t){var a=angular.copy(t);return a.getFullYear()===n.calendar.year&&a.getMonth()===n.calendar.month},n.calendarDirection=n.calendarDirection||"horizontal",n.$watch("calendarDirection",function(t){n.weekLayout="horizontal"===t?"row":"column"}),n.$watch("weekLayout",function(){l=n.calendar.year,i=n.calendar.month,y()});function d(t,a){(t||angular.noop)(a)}function c(t,e){var n=-1;return angular.forEach(t,function(t,a){n<0&&angular.equals(e,t)&&(n=a)}),n}n.isActive=function(t){var a=angular.copy(n.active),e=angular.isArray(a)?-1<c(a,t):angular.equals(t,a);return e},n.prev=function(){n.calendar.prev();var t={year:n.calendar.year,month:n.calendar.month+1};g(),d(n.onPrevMonth,t)},n.next=function(){n.calendar.next();var t={year:n.calendar.year,month:n.calendar.month+1};g(),d(n.onNextMonth,t)},n.handleDayClick=function(t){var a,e=angular.copy(n.active);angular.isArray(e)?-1<(a=c(e,t))?e.splice(a,1):e.push(t):e=angular.equals(e,t)?null:t,n.active=e,o.ngModel&&f(o.ngModel).assign(n.$parent,angular.copy(n.active)),w.log("isActive",n.active,t,n.isActive(t)),d(n.onDayClick,angular.copy(t))};function s(t){a.html(t),p(a.contents())(n)}function u(){n.calendar=new k(l,i,{weekStartsOn:n.weekStartsOn||0});var t=b.defer();return n.templateUrl?v.get(n.templateUrl).success(t.resolve).error(t.reject):t.resolve(n.template()||"<md-content layout='column' layout-fill flex md-swipe-left='next()' md-swipe-right='prev()'><md-toolbar><div class='md-toolbar-tools' layout='row'><md-button ng-click='prev()' aria-label='Previous month'><md-tooltip ng-if='::tooltips()'>Previous month</md-tooltip>&laquo;</md-button><div flex></div><h2 class='calendar-md-title'><span>{{ calendar.start | date:titleFormat:timezone }}</span></h2><div flex></div><md-button ng-click='next()' aria-label='Next month'><md-tooltip ng-if='::tooltips()'>Next month</md-tooltip>&raquo;</md-button></div></md-toolbar>\x3c!-- agenda view --\x3e<md-content ng-if='weekLayout === columnWeekLayout' class='agenda'><div ng-repeat='week in calendar.weeks track by $index'><div ng-if='sameMonth(day)' ng-class='{ active: active === day }' ng-click='handleDayClick(day)' ng-repeat='day in week' layout><md-tooltip ng-if='::tooltips()'>{{ day | date:dayTooltipFormat:timezone }}</md-tooltip><div>{{ day | date:dayFormat:timezone }}</div><div flex ng-bind-html='getDayContent(day)'></div></div></div></md-content>\x3c!-- calendar view --\x3e<md-content ng-if='weekLayout !== columnWeekLayout' flex layout='column' class='calendar'><div layout='row' layout-fill class='subheader'><div layout-padding class='subheader-day' flex ng-repeat='day in calendar.weeks[0]'><md-tooltip ng-if='::tooltips()'>{{ day | date:dayLabelTooltipFormat }}</md-tooltip>{{ day | date:dayLabelFormat }}</div></div><div ng-if='week.length' ng-repeat='week in calendar.weeks track by $index' flex layout='row' layout-fill><div tabindex='{{ sameMonth(day) ? (day | date:dayFormat:timezone) : 0 }}' ng-repeat='day in week track by $index' ng-click='handleDayClick(day)' flex layout layout-padding ng-class='{&quot;disabled&quot; : ! sameMonth(day), &quot;active&quot;: isActive(day), &quot;md-whiteframe-12dp&quot;: hover || focus }' ng-focus='focus = true;' ng-blur='focus = false;' ng-mouseleave='hover = false' ng-mouseenter='hover = true'><md-tooltip ng-if='::tooltips()'>{{ day | date:dayTooltipFormat }}</md-tooltip><div>{{ day | date:dayFormat }}</div><div flex ng-bind-html='data[dayKey(day)]'></div></div></div></md-content></md-content>"),t.promise}function m(t){return[t.getFullYear(),t.getMonth()+1,t.getDate()].join("-")}n.data={},n.dayKey=m;function h(a){n.data[m(a)]=n.data[m(a)]||"";var t=((n.dayContent||angular.noop)()||angular.noop)(a);angular.isObject(t)&&"function"==typeof t.success?t.success(function(t){n.data[m(a)]=t}):angular.isObject(t)&&"function"==typeof t.then?t.then(function(t){n.data[m(a)]=t}):n.data[m(a)]=t}var g=function(){angular.forEach(n.calendar.weeks,function(t){angular.forEach(t,h)})};window.data=n.data;var y=function(){u().then(function(t){s(t),g()})};n.$watch("weekStartsOn",u),y(),n._$$init=u,n._$$setTemplate=s,n._$$bootstrap=y}}}]);