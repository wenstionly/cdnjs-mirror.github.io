function isExist(e){return null!=e}function isFunction(e){return"function"==typeof e}function isBoolean(e){return"boolean"==typeof e}var defaultLang={uiv:{datePicker:{clear:"Clear",today:"Today",month:"Month",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",year:"Year",week1:"Mon",week2:"Tue",week3:"Wed",week4:"Thu",week5:"Fri",week6:"Sat",week7:"Sun"},timePicker:{am:"AM",pm:"PM"},modal:{cancel:"Cancel",ok:"OK"},multiSelect:{placeholder:"Select...",filterPlaceholder:"Search..."}}},lang=defaultLang,i18nHandler=function(){var e=Object.getPrototypeOf(this).$t;if(isFunction(e))try{return e.apply(this,arguments)}catch(e){return this.$t.apply(this,arguments)}},t=function(e,t){t=t||{};var n=i18nHandler.apply(this,arguments);if(isExist(n)&&!t.$$locale)return n;for(var o=e.split("."),i=t.$$locale||lang,r=0,s=o.length;r<s;r++){if(n=i[o[r]],r===s-1)return n;if(!n)return"";i=n}return""},defineProperty=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Local={methods:{t:function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return n[1]=_extends({$$locale:this.locale},n[1]),t.apply(this,n)}},props:{locale:Object}},EVENTS={MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",FOCUS:"focus",BLUR:"blur",CLICK:"click",INPUT:"input",KEY_DOWN:"keydown",KEY_UP:"keyup",KEY_PRESS:"keypress",RESIZE:"resize",SCROLL:"scroll",TOUCH_START:"touchstart",TOUCH_END:"touchend"};function on(e,t,n){e.addEventListener(t,n)}function off(e,t,n){e.removeEventListener(t,n)}function isElement(e){return e&&e.nodeType===Node.ELEMENT_NODE}function setDropdownPosition(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=document.documentElement,i=(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0),r=(window.pageYOffset||o.scrollTop)-(o.clientTop||0),s=t.getBoundingClientRect(),l=e.getBoundingClientRect();e.style.right="auto",e.style.bottom="auto",n.menuRight?e.style.left=i+s.left+s.width-l.width+"px":e.style.left=i+s.left+"px",n.dropup?e.style.top=r+s.top-l.height-4+"px":e.style.top=r+s.top+s.height+"px"}function focus(e){isElement(e)&&(!e.getAttribute("tabindex")&&e.setAttribute("tabindex","-1"),e.focus())}var DEFAULT_TAG="div",Dropdown={render:function(e){return e(this.tag,{class:{"btn-group":this.tag===DEFAULT_TAG,dropdown:!this.dropup,dropup:this.dropup,open:this.show}},[this.$slots.default,e("ul",{class:{"dropdown-menu":!0,"dropdown-menu-right":this.menuRight},ref:"dropdown"},[this.$slots.dropdown])])},props:{tag:{type:String,default:DEFAULT_TAG},appendToBody:{type:Boolean,default:!1},value:Boolean,dropup:{type:Boolean,default:!1},menuRight:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},notCloseElements:Array,positionElement:null},data:function(){return{show:!1,triggerEl:void 0}},watch:{value:function(e){this.toggle(e)}},mounted:function(){this.initTrigger(),this.triggerEl&&(on(this.triggerEl,EVENTS.CLICK,this.toggle),on(this.triggerEl,EVENTS.KEY_DOWN,this.onKeyPress)),on(this.$refs.dropdown,EVENTS.KEY_DOWN,this.onKeyPress),on(window,EVENTS.CLICK,this.windowClicked),on(window,EVENTS.TOUCH_END,this.windowClicked),this.value&&this.toggle(!0)},beforeDestroy:function(){this.removeDropdownFromBody(),this.triggerEl&&(off(this.triggerEl,EVENTS.CLICK,this.toggle),off(this.triggerEl,EVENTS.KEY_DOWN,this.onKeyPress)),off(this.$refs.dropdown,EVENTS.KEY_DOWN,this.onKeyPress),off(window,EVENTS.CLICK,this.windowClicked),off(window,EVENTS.TOUCH_END,this.windowClicked)},methods:{onKeyPress:function(e){if(this.show){var t=this.$refs.dropdown,n=e.keyCode||e.which;if(27===n)this.toggle(!1),this.triggerEl&&this.triggerEl.focus();else if(13===n){var o=t.querySelector("li > a:focus");o&&o.click()}else if(38===n||40===n){e.preventDefault(),e.stopPropagation();var i=t.querySelector("li > a:focus"),r=t.querySelectorAll("li:not(.disabled) > a");if(i){for(var s=0;s<r.length;s++)if(i===r[s]){38===n&&s<r.length>0?focus(r[s-1]):40===n&&s<r.length-1&&focus(r[s+1]);break}}else focus(r[0])}}},initTrigger:function(){var e=this.$el.querySelector('[data-role="trigger"]')||this.$el.querySelector(".dropdown-toggle")||this.$el.firstChild;this.triggerEl=e&&e!==this.$refs.dropdown?e:null},toggle:function(e){this.disabled||(isBoolean(e)?this.show=e:this.show=!this.show,this.appendToBody&&(this.show?this.appendDropdownToBody():this.removeDropdownFromBody()),this.$emit("input",this.show))},windowClicked:function(e){var t=e.target;if(this.show&&t){var n=!1;if(this.notCloseElements)for(var o=0,i=this.notCloseElements.length;o<i;o++){var r=this.notCloseElements[o].contains(t),s=r;if(this.appendToBody){var l=this.$refs.dropdown.contains(t),a=this.notCloseElements.indexOf(this.$el)>=0;s=r||l&&a}if(s){n=!0;break}}var u=this.$refs.dropdown.contains(t),p=this.$el.contains(t)&&!u,d=u&&"touchend"===e.type;p||n||d||this.toggle(!1)}},appendDropdownToBody:function(){try{var e=this.$refs.dropdown;e.style.display="block",document.body.appendChild(e),setDropdownPosition(e,this.positionElement||this.$el,this)}catch(e){}},removeDropdownFromBody:function(){try{var e=this.$refs.dropdown;e.removeAttribute("style"),this.$el.appendChild(e)}catch(e){}}}};function onlyUnique(e,t,n){return n.indexOf(e)===t}var MultiSelect={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("dropdown",{ref:"dropdown",style:e.containerStyles,attrs:{"not-close-elements":e.els,"append-to-body":e.appendToBody,disabled:e.disabled},nativeOn:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.showDropdown=!1}},model:{value:e.showDropdown,callback:function(t){e.showDropdown=t},expression:"showDropdown"}},[n("div",{staticClass:"form-control dropdown-toggle clearfix",class:e.selectClasses,attrs:{disabled:e.disabled,tabindex:"0","data-role":"trigger"},on:{focus:function(t){return e.$emit("focus",t)},blur:function(t){return e.$emit("blur",t)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),t.stopPropagation(),e.goNextOption(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),t.stopPropagation(),e.goPrevOption(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),t.stopPropagation(),e.selectOption(t))}]}},[n("div",{staticClass:"pull-right",staticStyle:{display:"inline-block","vertical-align":"middle"}},[n("span",[e._v("Â ")]),e._v(" "),n("span",{staticClass:"caret"})]),e._v(" "),n("div",{class:e.selectTextClasses,staticStyle:{"overflow-x":"hidden","text-overflow":"ellipsis","white-space":"nowrap"},domProps:{textContent:e._s(e.selectedText)}})]),e._v(" "),n("template",{slot:"dropdown"},[e.filterable?n("li",{staticStyle:{padding:"4px 8px"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.filterInput,expression:"filterInput"}],ref:"filterInput",staticClass:"form-control input-sm",attrs:{"aria-label":"Filter...",type:"text",placeholder:e.filterPlaceholder||e.t("uiv.multiSelect.filterPlaceholder")},domProps:{value:e.filterInput},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),t.stopPropagation(),e.goNextOption(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),t.stopPropagation(),e.goPrevOption(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),t.stopPropagation(),e.selectOption(t))}],input:function(t){t.target.composing||(e.filterInput=t.target.value)}}})]):e._e(),e._v(" "),e._l(e.groupedOptions,function(t){return[t.$group?n("li",{staticClass:"dropdown-header",domProps:{textContent:e._s(t.$group)}}):e._e(),e._v(" "),e._l(t.options,function(t){return[n("li",{class:e.itemClasses(t),staticStyle:{outline:"0"},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),t.stopPropagation(),e.goNextOption(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),t.stopPropagation(),e.goPrevOption(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),t.stopPropagation(),e.selectOption(t))}],click:function(n){return n.stopPropagation(),e.toggle(t)},mouseenter:function(t){e.currentActive=-1}}},[e.isItemSelected(t)?n("a",{staticStyle:{outline:"0"},attrs:{role:"button"}},[n("b",[e._v(e._s(t[e.labelKey]))]),e._v(" "),e.selectedIcon?n("span",{class:e.selectedIconClasses}):e._e()]):n("a",{staticStyle:{outline:"0"},attrs:{role:"button"}},[n("span",[e._v(e._s(t[e.labelKey]))])])])]})]})],2)],2)},staticRenderFns:[],mixins:[Local],components:{Dropdown:Dropdown},props:{value:{type:Array,required:!0},options:{type:Array,required:!0},labelKey:{type:String,default:"label"},valueKey:{type:String,default:"value"},limit:{type:Number,default:0},size:String,placeholder:String,split:{type:String,default:", "},disabled:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!1},block:{type:Boolean,default:!1},collapseSelected:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},filterAutoFocus:{type:Boolean,default:!0},filterFunction:Function,filterPlaceholder:String,selectedIcon:{type:String,default:"glyphicon glyphicon-ok"},itemSelectedClass:String},data:function(){return{showDropdown:!1,els:[],filterInput:"",currentActive:-1}},computed:{containerStyles:function(){return{width:this.block?"100%":""}},filteredOptions:function(){var e=this;if(this.filterable&&this.filterInput){if(this.filterFunction)return this.filterFunction(this.filterInput);var t=this.filterInput.toLowerCase();return this.options.filter(function(n){return n[e.valueKey].toString().toLowerCase().indexOf(t)>=0||n[e.labelKey].toString().toLowerCase().indexOf(t)>=0})}return this.options},groupedOptions:function(){var e=this;return this.filteredOptions.map(function(e){return e.group}).filter(onlyUnique).map(function(t){return{options:e.filteredOptions.filter(function(e){return e.group===t}),$group:t}})},flatternGroupedOptions:function(){if(this.groupedOptions&&this.groupedOptions.length){var e=[];return this.groupedOptions.forEach(function(t){e=e.concat(t.options)}),e}return[]},selectClasses:function(){return defineProperty({},"input-"+this.size,this.size)},selectedIconClasses:function(){var e;return defineProperty(e={},this.selectedIcon,!0),defineProperty(e,"pull-right",!0),e},selectTextClasses:function(){return{"text-muted":0===this.value.length}},labelValue:function(){var e=this,t=this.options.map(function(t){return t[e.valueKey]});return this.value.map(function(n){var o=t.indexOf(n);return o>=0?e.options[o][e.labelKey]:n})},selectedText:function(){if(this.value.length){var e=this.labelValue;if(this.collapseSelected){var t=e[0];return t+=e.length>1?this.split+"+"+(e.length-1):""}return e.join(this.split)}return this.placeholder||this.t("uiv.multiSelect.placeholder")}},watch:{showDropdown:function(e){var t=this;this.filterInput="",this.currentActive=-1,this.$emit("visible-change",e),e&&this.filterable&&this.filterAutoFocus&&this.$nextTick(function(){t.$refs.filterInput.focus()})}},mounted:function(){this.els=[this.$el]},methods:{goPrevOption:function(){this.showDropdown&&(this.currentActive>0?this.currentActive--:this.currentActive=this.flatternGroupedOptions.length-1)},goNextOption:function(){this.showDropdown&&(this.currentActive<this.flatternGroupedOptions.length-1?this.currentActive++:this.currentActive=0)},selectOption:function(){var e=this.currentActive,t=this.flatternGroupedOptions;this.showDropdown?e>=0&&e<t.length&&this.toggle(t[e]):this.showDropdown=!0},itemClasses:function(e){var t={disabled:e.disabled,active:this.currentActive===this.flatternGroupedOptions.indexOf(e)};return this.itemSelectedClass&&(t[this.itemSelectedClass]=this.isItemSelected(e)),t},isItemSelected:function(e){return this.value.indexOf(e[this.valueKey])>=0},toggle:function(e){if(!e.disabled){var t=e[this.valueKey],n=this.value.indexOf(t);if(1===this.limit){var o=n>=0?[]:[t];this.$emit("input",o),this.$emit("change",o)}else if(n>=0){var i=this.value.slice();i.splice(n,1),this.$emit("input",i),this.$emit("change",i)}else if(0===this.limit||this.value.length<this.limit){var r=this.value.slice();r.push(t),this.$emit("input",r),this.$emit("change",r)}else this.$emit("limit-exceed")}}}};export default MultiSelect;