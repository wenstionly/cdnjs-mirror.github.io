import Vue from"vue";var TYPES={ALERT:0,CONFIRM:1,PROMPT:2};function isExist(e){return null!=e}function isFunction(e){return"function"==typeof e}function isString(e){return"string"==typeof e}function isPromiseSupported(){return"undefined"!=typeof window&&isExist(window.Promise)}var EVENTS={MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",FOCUS:"focus",BLUR:"blur",CLICK:"click",INPUT:"input",KEY_DOWN:"keydown",KEY_UP:"keyup",KEY_PRESS:"keypress",RESIZE:"resize",SCROLL:"scroll",TOUCH_START:"touchstart",TOUCH_END:"touchend"};function isIE11(){return!!window.MSInputMethodContext&&!!document.documentMode}function isIE10(){return-1!==window.navigator.appVersion.indexOf("MSIE 10")}function getComputedStyle(e){return window.getComputedStyle(e)}function getViewportSize(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}}var scrollbarWidth=null,savedScreenSize=null;function getScrollbarWidth(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=getViewportSize();if(null!==scrollbarWidth&&!e&&t.height===savedScreenSize.height&&t.width===savedScreenSize.width)return scrollbarWidth;if("loading"===document.readyState)return null;var n=document.createElement("div"),o=document.createElement("div");return n.style.width=o.style.width=n.style.height=o.style.height="100px",n.style.overflow="scroll",o.style.overflow="hidden",document.body.appendChild(n),document.body.appendChild(o),scrollbarWidth=Math.abs(n.scrollHeight-o.scrollHeight),document.body.removeChild(n),document.body.removeChild(o),savedScreenSize=t,scrollbarWidth}function on(e,t,n){e.addEventListener(t,n)}function off(e,t,n){e.removeEventListener(t,n)}function isElement(e){return e&&e.nodeType===Node.ELEMENT_NODE}function removeFromDom(e){isElement(e)&&isElement(e.parentNode)&&e.parentNode.removeChild(e)}function addClass(e,t){if(isElement(e))if(e.className){var n=e.className.split(" ");n.indexOf(t)<0&&(n.push(t),e.className=n.join(" "))}else e.className=t}function removeClass(e,t){if(isElement(e)&&e.className){for(var n=e.className.split(" "),o=[],i=0,a=n.length;i<a;i++)n[i]!==t&&o.push(n[i]);e.className=o.join(" ")}}function hasScrollbar(e){var t=e.scrollHeight>e.clientHeight,n=getComputedStyle(e);return t||"scroll"===n.overflow||"scroll"===n.overflowY}function toggleBodyOverflow(e){var t=document.body;if(e)removeClass(t,"modal-open"),t.style.paddingRight=null;else{var n=isIE10()||isIE11();(hasScrollbar(document.documentElement)||hasScrollbar(document.body))&&!n&&(t.style.paddingRight=getScrollbarWidth()+"px"),addClass(t,"modal-open")}}function spliceIfExist(e,t){if(Array.isArray(e)){var n=e.indexOf(t);n>=0&&e.splice(n,1)}}var defaultLang={uiv:{datePicker:{clear:"Clear",today:"Today",month:"Month",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",year:"Year",week1:"Mon",week2:"Tue",week3:"Wed",week4:"Thu",week5:"Fri",week6:"Sat",week7:"Sun"},timePicker:{am:"AM",pm:"PM"},modal:{cancel:"Cancel",ok:"OK"},multiSelect:{placeholder:"Select...",filterPlaceholder:"Search..."}}},lang=defaultLang,i18nHandler=function(){var e=Object.getPrototypeOf(this).$t;if(isFunction(e))try{return e.apply(this,arguments)}catch(e){return this.$t.apply(this,arguments)}},t=function(e,t){t=t||{};var n=i18nHandler.apply(this,arguments);if(isExist(n)&&!t.$$locale)return n;for(var o=e.split("."),i=t.$$locale||lang,a=0,r=o.length;a<r;a++){if(n=i[o[a]],a===r-1)return n;if(!n)return"";i=n}return""},defineProperty=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Local={methods:{t:function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return n[1]=_extends({$$locale:this.locale},n[1]),t.apply(this,n)}},props:{locale:Object}};function mergeData(){for(var e,t,n={},o=arguments.length;o--;)for(var i=0,a=Object.keys(arguments[o]);i<a.length;i++)switch(e=a[i]){case"class":case"style":case"directives":Array.isArray(n[e])||(n[e]=[]),n[e]=n[e].concat(arguments[o][e]);break;case"staticClass":if(!arguments[o][e])break;void 0===n[e]&&(n[e]=""),n[e]&&(n[e]+=" "),n[e]+=arguments[o][e].trim();break;case"on":case"nativeOn":n[e]||(n[e]={});for(var r=0,l=Object.keys(arguments[o][e]);r<l.length;r++)t=l[r],n[e][t]?n[e][t]=[].concat(n[e][t],arguments[o][e][t]):n[e][t]=arguments[o][e][t];break;case"attrs":case"props":case"domProps":case"scopedSlots":case"staticStyle":case"hook":case"transition":n[e]||(n[e]={}),n[e]=__assign({},arguments[o][e],n[e]);break;case"slot":case"key":case"ref":case"tag":case"show":case"keepAlive":default:n[e]||(n[e]=arguments[o][e])}return n}var __assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},linkMixin={props:{href:String,target:String,to:null,replace:{type:Boolean,default:!1},append:{type:Boolean,default:!1},exact:{type:Boolean,default:!1}}},BtnGroup={functional:!0,render:function(e,t){var n=t.props,o=t.children;return e("div",mergeData(t.data,{class:defineProperty({"btn-group":!n.vertical,"btn-group-vertical":n.vertical,"btn-group-justified":n.justified},"btn-group-"+n.size,n.size),attrs:{role:"group","data-toggle":"buttons"}}),o)},props:{size:String,vertical:{type:Boolean,default:!1},justified:{type:Boolean,default:!1}}},INPUT_TYPE_CHECKBOX="checkbox",INPUT_TYPE_RADIO="radio",Btn={functional:!0,mixins:[linkMixin],render:function(e,t){var n,o=t.children,i=t.props,a=t.data,r=a.on||{},l=i.inputType===INPUT_TYPE_CHECKBOX?i.value.indexOf(i.inputValue)>=0:i.value===i.inputValue,s=(n={btn:!0,active:i.inputType?l:i.active,disabled:i.disabled,"btn-block":i.block},defineProperty(n,"btn-"+i.type,Boolean(i.type)),defineProperty(n,"btn-"+i.size,Boolean(i.size)),n),u={click:function(e){i.disabled&&e instanceof Event&&(e.preventDefault(),e.stopPropagation())}},c=void 0,d=void 0,p=void 0;return i.href?(c="a",p=o,d=mergeData(a,{on:u,class:s,attrs:{role:"button",href:i.href,target:i.target}})):i.to?(c="router-link",p=o,d=mergeData(a,{nativeOn:u,class:s,props:{event:i.disabled?"":"click",to:i.to,replace:i.replace,append:i.append,exact:i.exact},attrs:{role:"button"}})):i.inputType?(c="label",d=mergeData(a,{on:u,class:s}),p=[e("input",{attrs:{autocomplete:"off",type:i.inputType,checked:l?"checked":null,disabled:i.disabled},domProps:{checked:l},on:{input:function(e){e.stopPropagation()},change:function(){if(i.inputType===INPUT_TYPE_CHECKBOX){var e=i.value.slice();l?e.splice(e.indexOf(i.inputValue),1):e.push(i.inputValue),r.input(e)}else r.input(i.inputValue)}}}),o]):i.justified?(c=BtnGroup,d={},p=[e("button",mergeData(a,{on:u,class:s,attrs:{type:i.nativeType,disabled:i.disabled}}),o)]):(c="button",p=o,d=mergeData(a,{on:u,class:s,attrs:{type:i.nativeType,disabled:i.disabled}})),e(c,d,p)},props:{justified:{type:Boolean,default:!1},type:{type:String,default:"default"},nativeType:{type:String,default:"button"},size:String,block:{type:Boolean,default:!1},active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},value:null,inputValue:null,inputType:{type:String,validator:function(e){return e===INPUT_TYPE_CHECKBOX||e===INPUT_TYPE_RADIO}}}},MODAL_BACKDROP="modal-backdrop",IN="in",getOpenModals=function(){return document.querySelectorAll("."+MODAL_BACKDROP)},getOpenModalNum=function(){return getOpenModals().length},Modal={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal",class:{fade:e.transitionDuration>0},attrs:{tabindex:"-1",role:"dialog"},on:{mousedown:function(t){return t.target!==t.currentTarget?null:e.backdropClicked(t)}}},[n("div",{ref:"dialog",staticClass:"modal-dialog",class:e.modalSizeClass,attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[e.header?n("div",{staticClass:"modal-header"},[e._t("header",[e.dismissBtn?n("button",{staticClass:"close",staticStyle:{position:"relative","z-index":"1060"},attrs:{type:"button","aria-label":"Close"},on:{click:function(t){return e.toggle(!1)}}},[n("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])]):e._e(),e._v(" "),n("h4",{staticClass:"modal-title"},[e._t("title",[e._v(e._s(e.title))])],2)])],2):e._e(),e._v(" "),n("div",{staticClass:"modal-body"},[e._t("default")],2),e._v(" "),e.footer?n("div",{staticClass:"modal-footer"},[e._t("footer",[n("btn",{attrs:{type:e.cancelType},on:{click:function(t){return e.toggle(!1,"cancel")}}},[n("span",[e._v(e._s(e.cancelText||e.t("uiv.modal.cancel")))])]),e._v(" "),n("btn",{attrs:{type:e.okType,"data-action":"auto-focus"},on:{click:function(t){return e.toggle(!1,"ok")}}},[n("span",[e._v(e._s(e.okText||e.t("uiv.modal.ok")))])])])],2):e._e()])]),e._v(" "),n("div",{ref:"backdrop",staticClass:"modal-backdrop",class:{fade:e.transitionDuration>0}})])},staticRenderFns:[],mixins:[Local],components:{Btn:Btn},props:{value:{type:Boolean,default:!1},title:String,size:String,backdrop:{type:Boolean,default:!0},footer:{type:Boolean,default:!0},header:{type:Boolean,default:!0},cancelText:String,cancelType:{type:String,default:"default"},okText:String,okType:{type:String,default:"primary"},dismissBtn:{type:Boolean,default:!0},transitionDuration:{type:Number,default:150},autoFocus:{type:Boolean,default:!1},keyboard:{type:Boolean,default:!0},beforeClose:Function,zOffset:{type:Number,default:20},appendToBody:{type:Boolean,default:!1},displayStyle:{type:String,default:"block"}},data:function(){return{msg:"",timeoutId:0}},computed:{modalSizeClass:function(){return defineProperty({},"modal-"+this.size,Boolean(this.size))}},watch:{value:function(e){this.$toggle(e)}},mounted:function(){removeFromDom(this.$refs.backdrop),on(window,EVENTS.KEY_UP,this.onKeyPress),this.value&&this.$toggle(!0)},beforeDestroy:function(){clearTimeout(this.timeoutId),removeFromDom(this.$refs.backdrop),removeFromDom(this.$el),0===getOpenModalNum()&&toggleBodyOverflow(!0),off(window,EVENTS.KEY_UP,this.onKeyPress)},methods:{onKeyPress:function(e){if(this.keyboard&&this.value&&27===e.keyCode){var t=this.$refs.backdrop,n=t.style.zIndex;n=n&&"auto"!==n?parseInt(n):0;for(var o=getOpenModals(),i=o.length,a=0;a<i;a++)if(o[a]!==t){var r=o[a].style.zIndex;if((r=r&&"auto"!==r?parseInt(r):0)>n)return}this.toggle(!1)}},toggle:function(e,t){var n=this,o=!0;if(isFunction(this.beforeClose)&&(o=this.beforeClose(t)),isPromiseSupported())Promise.resolve(o).then(function(o){!e&&o&&(n.msg=t,n.$emit("input",e))});else{if(!e&&!o)return;this.msg=t,this.$emit("input",e)}},$toggle:function(e){var t=this,n=this.$el,o=this.$refs.backdrop;if(clearTimeout(this.timeoutId),e){var i=getOpenModalNum();if(document.body.appendChild(o),this.appendToBody&&document.body.appendChild(n),n.style.display=this.displayStyle,n.scrollTop=0,o.offsetHeight,toggleBodyOverflow(!1),addClass(o,IN),addClass(n,IN),i>0){var a=parseInt(getComputedStyle(n).zIndex)||1050,r=parseInt(getComputedStyle(o).zIndex)||1040,l=i*this.zOffset;n.style.zIndex=""+(a+l),o.style.zIndex=""+(r+l)}this.timeoutId=setTimeout(function(){if(t.autoFocus){var e=t.$el.querySelector('[data-action="auto-focus"]');e&&e.focus()}t.$emit("show"),t.timeoutId=0},this.transitionDuration)}else removeClass(o,IN),removeClass(n,IN),this.timeoutId=setTimeout(function(){n.style.display="none",removeFromDom(o),t.appendToBody&&removeFromDom(n),0===getOpenModalNum()&&toggleBodyOverflow(!0),t.$emit("hide",t.msg||"dismiss"),t.msg="",t.timeoutId=0,n.style.zIndex="",o.style.zIndex=""},this.transitionDuration)},backdropClicked:function(e){this.backdrop&&this.toggle(!1)}}},MessageBox$1={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{ref:"modal",class:e.customClass,attrs:{"auto-focus":"",size:e.size,title:e.title,header:!!e.title,backdrop:e.closeOnBackdropClick,"cancel-text":e.cancelText,"ok-text":e.okText},on:{hide:e.cb},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e.html?n("div",{domProps:{innerHTML:e._s(e.content)}}):n("p",[e._v(e._s(e.content))]),e._v(" "),e.type===e.TYPES.PROMPT?n("div",[n("div",{staticClass:"form-group",class:{"has-error":e.inputNotValid}},["checkbox"===e.inputType?n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],ref:"input",staticClass:"form-control",attrs:{required:"","data-action":"auto-focus",type:"checkbox"},domProps:{checked:Array.isArray(e.input)?e._i(e.input,null)>-1:e.input},on:{change:[function(t){var n=e.input,o=t.target,i=!!o.checked;if(Array.isArray(n)){var a=e._i(n,null);o.checked?a<0&&(e.input=n.concat([null])):a>-1&&(e.input=n.slice(0,a).concat(n.slice(a+1)))}else e.input=i},function(t){e.dirty=!0}],keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validate(t)}}}):"radio"===e.inputType?n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],ref:"input",staticClass:"form-control",attrs:{required:"","data-action":"auto-focus",type:"radio"},domProps:{checked:e._q(e.input,null)},on:{change:[function(t){e.input=null},function(t){e.dirty=!0}],keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validate(t)}}}):n("input",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],ref:"input",staticClass:"form-control",attrs:{required:"","data-action":"auto-focus",type:e.inputType},domProps:{value:e.input},on:{change:function(t){e.dirty=!0},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validate(t)},input:function(t){t.target.composing||(e.input=t.target.value)}}}),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.inputNotValid,expression:"inputNotValid"}],staticClass:"help-block"},[e._v(e._s(e.inputError))])])]):e._e(),e._v(" "),e.type===e.TYPES.ALERT?n("template",{slot:"footer"},[n("btn",{attrs:{type:e.okType,"data-action":"ok"===e.autoFocus?"auto-focus":""},domProps:{textContent:e._s(e.okBtnText)},on:{click:function(t){return e.toggle(!1,"ok")}}})],1):n("template",{slot:"footer"},[n("btn",{attrs:{type:e.cancelType,"data-action":"cancel"===e.autoFocus?"auto-focus":""},domProps:{textContent:e._s(e.cancelBtnText)},on:{click:function(t){return e.toggle(!1,"cancel")}}}),e._v(" "),e.type===e.TYPES.CONFIRM?n("btn",{attrs:{type:e.okType,"data-action":"ok"===e.autoFocus?"auto-focus":""},domProps:{textContent:e._s(e.okBtnText)},on:{click:function(t){return e.toggle(!1,"ok")}}}):n("btn",{attrs:{type:e.okType},domProps:{textContent:e._s(e.okBtnText)},on:{click:e.validate}})],1)],2)},staticRenderFns:[],mixins:[Local],components:{Modal:Modal,Btn:Btn},props:{backdrop:null,title:String,content:String,html:{type:Boolean,default:!1},okText:String,okType:{type:String,default:"primary"},cancelText:String,cancelType:{type:String,default:"default"},type:{type:Number,default:TYPES.ALERT},size:{type:String,default:"sm"},cb:{type:Function,required:!0},validator:{type:Function,default:function(){return null}},customClass:null,defaultValue:String,inputType:{type:String,default:"text"},autoFocus:{type:String,default:"ok"}},data:function(){return{TYPES:TYPES,show:!1,input:"",dirty:!1}},mounted:function(){this.defaultValue&&(this.input=this.defaultValue)},computed:{closeOnBackdropClick:function(){return isExist(this.backdrop)?Boolean(this.backdrop):this.type!==TYPES.ALERT},inputError:function(){return this.validator(this.input)},inputNotValid:function(){return this.dirty&&this.inputError},okBtnText:function(){return this.okText||this.t("uiv.modal.ok")},cancelBtnText:function(){return this.cancelText||this.t("uiv.modal.cancel")}},methods:{toggle:function(e,t){this.$refs.modal.toggle(e,t)},validate:function(){this.dirty=!0,isExist(this.inputError)||this.toggle(!1,{value:this.input})}}},queue=[],destroy=function(e){removeFromDom(e.$el),e.$destroy(),spliceIfExist(queue,e)},shallResolve=function(e,t){return e===TYPES.CONFIRM?"ok"===t:isExist(t)&&isString(t.value)},init=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=this.$i18n,r=new Vue({extends:MessageBox$1,i18n:a,propsData:_extends({type:e},t,{cb:function(t){destroy(r),isFunction(n)?e===TYPES.CONFIRM?shallResolve(e,t)?n(null,t):n(t):e===TYPES.PROMPT&&shallResolve(e,t)?n(null,t.value):n(t):o&&i&&(e===TYPES.CONFIRM?shallResolve(e,t)?o(t):i(t):e===TYPES.PROMPT?shallResolve(e,t)?o(t.value):i(t):o(t))}})});r.$mount(),document.body.appendChild(r.$el),r.show=!0,queue.push(r)},initModal=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2];if(isPromiseSupported())return new Promise(function(i,a){init.apply(t,[e,n,o,i,a])});init.apply(this,[e,n,o])},alert=function(e,t){return initModal.apply(this,[TYPES.ALERT,e,t])},confirm=function(e,t){return initModal.apply(this,[TYPES.CONFIRM,e,t])},prompt=function(e,t){return initModal.apply(this,[TYPES.PROMPT,e,t])},MessageBox={alert:alert,confirm:confirm,prompt:prompt};export default MessageBox;