var EVENTS={MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",FOCUS:"focus",BLUR:"blur",CLICK:"click",INPUT:"input",KEY_DOWN:"keydown",KEY_UP:"keyup",KEY_PRESS:"keypress",RESIZE:"resize",SCROLL:"scroll",TOUCH_START:"touchstart",TOUCH_END:"touchend"};function getViewportSize(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}}function on(e,t,n){e.addEventListener(t,n)}function off(e,t,n){e.removeEventListener(t,n)}function isElement(e){return e&&e.nodeType===Node.ELEMENT_NODE}function ensureElementMatchesFunction(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1})}function addClass(e,t){if(isElement(e))if(e.className){var n=e.className.split(" ");n.indexOf(t)<0&&(n.push(t),e.className=n.join(" "))}else e.className=t}function removeClass(e,t){if(isElement(e)&&e.className){for(var n=e.className.split(" "),o=[],r=0,l=n.length;r<l;r++)n[r]!==t&&o.push(n[r]);e.className=o.join(" ")}}function getClosest(e,t){ensureElementMatchesFunction();for(var n=void 0,o=e;o;){if((n=o.parentElement)&&n.matches(t))return n;o=n}return null}function getParents(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;ensureElementMatchesFunction();for(var o=[],r=e.parentElement;r;){if(r.matches(t))o.push(r);else if(n&&(n===r||r.matches(n)))break;r=r.parentElement}return o}function nodeListToArray(e){return Array.prototype.slice.call(e||[])}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function ScrollSpy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.el=e,this.opts=_extends({},ScrollSpy.DEFAULTS,n),this.opts.target=t,this.scrollElement="body"===t?window:document.querySelector("[id="+t+"]"),this.selector="li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.scrollElement&&(this.refresh(),this.process())}ScrollSpy.DEFAULTS={offset:10,callback:function(e){return 0}},ScrollSpy.prototype.getScrollHeight=function(){return this.scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},ScrollSpy.prototype.refresh=function(){var e=this;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var t=nodeListToArray(this.el.querySelectorAll(this.selector)),n=this.scrollElement===window;t.map(function(t){var o=t.getAttribute("href");if(/^#./.test(o)){var r=document.documentElement,l=(n?document:e.scrollElement).querySelector("[id='"+o.slice(1)+"']"),s=(window.pageYOffset||r.scrollTop)-(r.clientTop||0);return[n?l.getBoundingClientRect().top+s:l.offsetTop+e.scrollElement.scrollTop,o]}return null}).filter(function(e){return e}).sort(function(e,t){return e[0]-t[0]}).forEach(function(t){e.offsets.push(t[0]),e.targets.push(t[1])})},ScrollSpy.prototype.process=function(){var e=this.scrollElement===window,t=(e?window.pageYOffset:this.scrollElement.scrollTop)+this.opts.offset,n=this.getScrollHeight(),o=e?getViewportSize().height:this.scrollElement.getBoundingClientRect().height,r=this.opts.offset+n-o,l=this.offsets,s=this.targets,i=this.activeTarget,c=void 0;if(this.scrollHeight!==n&&this.refresh(),t>=r)return i!==(c=s[s.length-1])&&this.activate(c);if(i&&t<l[0])return this.activeTarget=null,this.clear();for(c=l.length;c--;)i!==s[c]&&t>=l[c]&&(void 0===l[c+1]||t<l[c+1])&&this.activate(s[c])},ScrollSpy.prototype.activate=function(e){this.activeTarget=e,this.clear();var t=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',n=this.opts.callback;nodeListToArray(this.el.querySelectorAll(t)).forEach(function(e){getParents(e,"li").forEach(function(e){addClass(e,"active"),n(e)}),getParents(e,".dropdown-menu").length&&addClass(getClosest(e,"li.dropdown"),"active")})},ScrollSpy.prototype.clear=function(){var e=this;nodeListToArray(this.el.querySelectorAll(this.selector)).forEach(function(t){getParents(t,".active",e.opts.target).forEach(function(e){removeClass(e,"active")})})};var INSTANCE="_uiv_scrollspy_instance",events=[EVENTS.RESIZE,EVENTS.SCROLL],bind=function(e,t){unbind(e)},inserted=function(e,t){var n=new ScrollSpy(e,t.arg,t.value);n.scrollElement&&(n.handler=function(){n.process()},events.forEach(function(e){on(n.scrollElement,e,n.handler)})),e[INSTANCE]=n},unbind=function(e){var t=e[INSTANCE];t&&t.scrollElement&&(events.forEach(function(e){off(t.scrollElement,e,t.handler)}),delete e[INSTANCE])},update=function(e,t){var n=t.arg!==t.oldArg,o=t.value!==t.oldValue;(n||o)&&(bind(e,t),inserted(e,t))},scrollspy={bind:bind,unbind:unbind,update:update,inserted:inserted};export default scrollspy;