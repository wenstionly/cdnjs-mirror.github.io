function isBoolean(t){return"boolean"==typeof t}var EVENTS={MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",FOCUS:"focus",BLUR:"blur",CLICK:"click",INPUT:"input",KEY_DOWN:"keydown",KEY_UP:"keyup",KEY_PRESS:"keypress",RESIZE:"resize",SCROLL:"scroll",TOUCH_START:"touchstart",TOUCH_END:"touchend"};function on(t,e,o){t.addEventListener(e,o)}function off(t,e,o){t.removeEventListener(e,o)}function isElement(t){return t&&t.nodeType===Node.ELEMENT_NODE}function setDropdownPosition(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=document.documentElement,n=(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0),s=(window.pageYOffset||i.scrollTop)-(i.clientTop||0),r=e.getBoundingClientRect(),l=t.getBoundingClientRect();t.style.right="auto",t.style.bottom="auto",o.menuRight?t.style.left=n+r.left+r.width-l.width+"px":t.style.left=n+r.left+"px",o.dropup?t.style.top=s+r.top-l.height-4+"px":t.style.top=s+r.top+r.height+"px"}function focus(t){isElement(t)&&(!t.getAttribute("tabindex")&&t.setAttribute("tabindex","-1"),t.focus())}var DEFAULT_TAG="div",Dropdown={render:function(t){return t(this.tag,{class:{"btn-group":this.tag===DEFAULT_TAG,dropdown:!this.dropup,dropup:this.dropup,open:this.show}},[this.$slots.default,t("ul",{class:{"dropdown-menu":!0,"dropdown-menu-right":this.menuRight},ref:"dropdown"},[this.$slots.dropdown])])},props:{tag:{type:String,default:DEFAULT_TAG},appendToBody:{type:Boolean,default:!1},value:Boolean,dropup:{type:Boolean,default:!1},menuRight:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},notCloseElements:Array,positionElement:null},data:function(){return{show:!1,triggerEl:void 0}},watch:{value:function(t){this.toggle(t)}},mounted:function(){this.initTrigger(),this.triggerEl&&(on(this.triggerEl,EVENTS.CLICK,this.toggle),on(this.triggerEl,EVENTS.KEY_DOWN,this.onKeyPress)),on(this.$refs.dropdown,EVENTS.KEY_DOWN,this.onKeyPress),on(window,EVENTS.CLICK,this.windowClicked),on(window,EVENTS.TOUCH_END,this.windowClicked),this.value&&this.toggle(!0)},beforeDestroy:function(){this.removeDropdownFromBody(),this.triggerEl&&(off(this.triggerEl,EVENTS.CLICK,this.toggle),off(this.triggerEl,EVENTS.KEY_DOWN,this.onKeyPress)),off(this.$refs.dropdown,EVENTS.KEY_DOWN,this.onKeyPress),off(window,EVENTS.CLICK,this.windowClicked),off(window,EVENTS.TOUCH_END,this.windowClicked)},methods:{onKeyPress:function(t){if(this.show){var e=this.$refs.dropdown,o=t.keyCode||t.which;if(27===o)this.toggle(!1),this.triggerEl&&this.triggerEl.focus();else if(13===o){var i=e.querySelector("li > a:focus");i&&i.click()}else if(38===o||40===o){t.preventDefault(),t.stopPropagation();var n=e.querySelector("li > a:focus"),s=e.querySelectorAll("li:not(.disabled) > a");if(n){for(var r=0;r<s.length;r++)if(n===s[r]){38===o&&r<s.length>0?focus(s[r-1]):40===o&&r<s.length-1&&focus(s[r+1]);break}}else focus(s[0])}}},initTrigger:function(){var t=this.$el.querySelector('[data-role="trigger"]')||this.$el.querySelector(".dropdown-toggle")||this.$el.firstChild;this.triggerEl=t&&t!==this.$refs.dropdown?t:null},toggle:function(t){this.disabled||(isBoolean(t)?this.show=t:this.show=!this.show,this.appendToBody&&(this.show?this.appendDropdownToBody():this.removeDropdownFromBody()),this.$emit("input",this.show))},windowClicked:function(t){var e=t.target;if(this.show&&e){var o=!1;if(this.notCloseElements)for(var i=0,n=this.notCloseElements.length;i<n;i++){var s=this.notCloseElements[i].contains(e),r=s;if(this.appendToBody){var l=this.$refs.dropdown.contains(e),d=this.notCloseElements.indexOf(this.$el)>=0;r=s||l&&d}if(r){o=!0;break}}var h=this.$refs.dropdown.contains(e),p=this.$el.contains(e)&&!h,f=h&&"touchend"===t.type;p||o||f||this.toggle(!1)}},appendDropdownToBody:function(){try{var t=this.$refs.dropdown;t.style.display="block",document.body.appendChild(t),setDropdownPosition(t,this.positionElement||this.$el,this)}catch(t){}},removeDropdownFromBody:function(){try{var t=this.$refs.dropdown;t.removeAttribute("style"),this.$el.appendChild(t)}catch(t){}}}};export default Dropdown;