!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).algoliasearch=t()}(this,function(){"use strict";function t(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function P(a){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?t(Object(o),!0).forEach(function(e){var t,r,n;t=a,n=o[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(o,e))})}return a}function h(e,t){if(null==e)return{};var r,n=function(e,t){if(null==e)return{};for(var r,n={},a=Object.keys(e),o=0;o<a.length;o++)r=a[o],0<=t.indexOf(r)||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols)for(var a=Object.getOwnPropertySymbols(e),o=0;o<a.length;o++)r=a[o],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(n=(u=s.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function O(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e){var u=0<arguments.length&&void 0!==e?e:{serializable:!0},s={};return{get:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}},n=JSON.stringify(e);if(n in s)return Promise.resolve(u.serializable?JSON.parse(s[n]):s[n]);var a=t(),o=r&&r.miss||function(){return Promise.resolve()};return a.then(function(e){return o(e)}).then(function(){return a})},set:function(e,t){return s[JSON.stringify(e)]=u.serializable?JSON.stringify(t):t,Promise.resolve(t)},delete:function(e){return delete s[JSON.stringify(e)],Promise.resolve()},clear:function(){return s={},Promise.resolve()}}}function g(e,t,r){var n={"x-algolia-api-key":r,"x-algolia-application-id":t};return{headers:function(){return e===w.WithinHeaders?n:{}},queryParameters:function(){return e===w.WithinQueryParameters?n:{}}}}function c(r){var n=0;return r(function t(){return n++,new Promise(function(e){setTimeout(function(){e(r(t))},Math.min(100*n,1e3))})})}function v(e,t){var r=1<arguments.length&&void 0!==t?t:function(e,t){return Promise.resolve()};return Object.assign(e,{wait:function(t){return v(e.then(function(e){return Promise.all([r(e,t),e])}).then(function(e){return e[1]}))}})}function b(t,r){return Object.keys(void 0!==r?r:{}).forEach(function(e){t[e]=r[e](t)}),t}function j(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=0;return e.replace(/%s/g,function(){return encodeURIComponent(r[a++])})}var w={WithinQueryParameters:0,WithinHeaders:1};function d(e,t){var r=e||{},n=r.data||{};return Object.keys(r).forEach(function(e){-1===["timeout","headers","queryParameters","data","cacheable"].indexOf(e)&&(n[e]=r[e])}),{data:0<Object.entries(n).length?n:void 0,timeout:r.timeout||t,headers:r.headers||{},queryParameters:r.queryParameters||{},cacheable:r.cacheable}}var I={Read:1,Write:2,Any:3},o=1,x=2,q=3;function D(e,t){return P({},e,{status:1<arguments.length&&void 0!==t?t:o,lastUpdate:Date.now()})}function l(e){return{protocol:e.protocol||"https",url:e.url,accept:e.accept||I.Any}}var u="DELETE",s="GET",S="POST";function a(t,a){return Promise.all(a.map(function(e){return t.get(e,function(){return Promise.resolve(D(e))})})).then(function(e){var t=e.filter(function(e){return(t=e).status===o||12e4<Date.now()-t.lastUpdate;var t}),r=e.filter(function(e){return(t=e).status===q&&Date.now()-t.lastUpdate<=12e4;var t}),n=[].concat(O(t),O(r));return{getTimeout:function(e,t){return(0===r.length&&0===e?1:r.length+3+e)*t},statelessHosts:0<n.length?n.map(l):a}})}function p(f,e,d,l){function p(r,n){var a=r.pop();if(void 0===a)throw{name:"RetryError",message:"Unreachable hosts - your application id may be incorrect. If the error persists, contact support@algolia.com.",transporterStackTrace:N(h)};function o(e){var t={request:i,response:e,host:a,triesLeft:r.length};return h.push(t),t}var e,t,u,s,i={data:m,headers:y,method:g,url:(e=a,t=d.path,u=k(v),s="".concat(e.protocol,"://").concat(e.url,"/").concat("/"===t.charAt(0)?t.substr(1):t),u.length&&(s+="?".concat(u)),s),connectTimeout:n(b,f.timeouts.connect),responseTimeout:n(b,l.timeout)},c={onSucess:function(t){try{return JSON.parse(t.content)}catch(e){throw function(e){return{name:"DeserializationError",message:e,response:t}}(e.message)}},onRetry:function(e){var t=o(e);return e.isTimedOut&&b++,Promise.all([f.logger.info("Retryable failure",R(t)),f.hostsCache.set(a,D(a,e.isTimedOut?q:x))]).then(function(){return p(r,n)})},onFail:function(e){throw o(e),function(e,t){var r=e.content,n=e.status,a=r;try{a=JSON.parse(r).message}catch(e){}return{name:"ApiError",message:a,status:n,transporterStackTrace:t}}(e,N(h))}};return f.requester.send(i).then(function(e){return r=c,u=(n=t=e).status,n.isTimedOut||(a=n.isTimedOut,o=n.status,!a&&0==~~o)||2!=~~(u/100)&&4!=~~(u/100)?r.onRetry(t):2==~~(t.status/100)?r.onSucess(t):r.onFail(t);var t,r,n,a,o,u})}var r,n,h=[],m=function(e,t){if(e.method!==s&&(void 0!==e.data||void 0!==t.data)){var r=Array.isArray(e.data)?e.data:P({},e.data,{},t.data);return JSON.stringify(r)}}(d,l),y=(r=P({},f.headers,{},l.headers),n={},Object.keys(r).forEach(function(e){var t=r[e];n[e.toLowerCase()]=t}),n),g=d.method,t=d.method!==s?{}:P({},d.data,{},l.data),v=P({"x-algolia-agent":f.userAgent.value},f.queryParameters,{},t,{},l.queryParameters),b=0;return a(f.hostsCache,e).then(function(e){return p(O(e.statelessHosts).reverse(),e.getTimeout)})}function T(e){var t=e.hostsCache,r=e.logger,n=e.requester,a=e.requestsCache,o=e.responsesCache,u=e.timeouts,s=e.userAgent,i=e.hosts,c=e.queryParameters,f={hostsCache:t,logger:r,requester:n,requestsCache:a,responsesCache:o,timeouts:u,userAgent:s,headers:e.headers,queryParameters:c,hosts:i.map(l),read:function(e,t){function r(){return p(f,f.hosts.filter(function(e){return 0!=(e.accept&I.Read)}),e,n)}var n=d(t,f.timeouts.read);if(!0!==(void 0!==n.cacheable?n.cacheable:e.cacheable))return r();var a={request:e,mappedRequestOptions:n,transporter:{queryParameters:f.queryParameters,headers:f.headers}};return f.responsesCache.get(a,function(){return f.requestsCache.get(a,function(){return f.requestsCache.set(a,r()).then(function(e){return Promise.all([f.requestsCache.delete(a),e])},function(e){return Promise.all([f.requestsCache.delete(a),Promise.reject(e)])}).then(function(e){var t=m(e,2);return t[0],t[1]})})},{miss:function(e){return f.responsesCache.set(a,e)}})},write:function(e,t){return p(f,f.hosts.filter(function(e){return 0!=(e.accept&I.Write)}),e,d(t,f.timeouts.write))}};return f}function k(r){return Object.keys(r).map(function(e){return j("%s=%s",e,(t=r[e],"[object Object]"===Object.prototype.toString.call(t)||"[object Array]"===Object.prototype.toString.call(t)?JSON.stringify(r[e]):r[e]));var t}).join("&")}function N(e){return e.map(R)}function R(e){var t=e.request.headers["x-algolia-api-key"]?{"x-algolia-api-key":"*****"}:{};return P({},e,{request:P({},e.request,{headers:P({},e.request.headers,{},t)})})}function A(r){return function(e,t){return r.transporter.write({method:S,path:"2/abtests",data:e},t)}}function E(r){return function(e,t){return r.transporter.write({method:u,path:j("2/abtests/%s",e)},t)}}function C(r){return function(e,t){return r.transporter.read({method:s,path:j("2/abtests/%s",e)},t)}}function U(t){return function(e){return t.transporter.read({method:s,path:"2/abtests"},e)}}function J(r){return function(e,t){return r.transporter.write({method:S,path:j("2/abtests/%s/stop",e)},t)}}function z(t){return function(e){return t.transporter.read({method:s,path:"1/strategies/personalization"},e)}}function F(r){return function(e,t){return r.transporter.write({method:S,path:"1/strategies/personalization",data:e},t)}}function n(n){return function t(r){return n.request(r).then(function(e){if(void 0!==n.batch&&n.batch(e.hits),!n.shouldStop(e))return e.cursor?t({cursor:e.cursor}):t({page:(r.page||0)+1})})}({})}function H(u){return function(e,t){var r=t||{},n=r.queryParameters,a=h(r,["queryParameters"]),o=P({acl:e},void 0!==n?{queryParameters:n}:{});return v(u.transporter.write({method:S,path:"1/keys",data:o},a),function(e,r){return c(function(t){return Fe(u)(e.key,r).catch(function(e){if(404!==e.status)throw e;return t()})})})}}function M(a){return function(e,t,r){var n=d(r);return n.queryParameters["X-Algolia-User-ID"]=e,a.transporter.write({method:S,path:"1/clusters/mapping",data:{cluster:t}},n)}}function K(n){return function(e,t,r){return n.transporter.write({method:S,path:"1/clusters/mapping/batch",data:{users:e,cluster:t}},r)}}function W(n){return function(r,e,t){return v(n.transporter.write({method:S,path:j("1/indexes/%s/operation",r),data:{operation:"copy",destination:e}},t),function(e,t){return He(n)(r,{methods:{waitTask:Ye}}).waitTask(e.taskID,t)})}}function B(n){return function(e,t,r){return W(n)(e,t,P({},r,{scope:[i.Rules]}))}}function Q(n){return function(e,t,r){return W(n)(e,t,P({},r,{scope:[i.Settings]}))}}function G(n){return function(e,t,r){return W(n)(e,t,P({},r,{scope:[i.Synonyms]}))}}function V(n){return function(r,e){return v(n.transporter.write({method:u,path:j("1/keys/%s",r)},e),function(e,t){return c(function(e){return Fe(n)(r,t).then(e).catch(function(e){if(404!==e.status)throw e})})})}}function L(t){return function(e){return t.transporter.read({method:s,path:"1/logs"},e)}}function _(t){return function(e){return t.transporter.read({method:s,path:"1/clusters/mapping/top"},e)}}function X(r){return function(e,t){return r.transporter.read({method:s,path:j("1/clusters/mapping/%s",e)},t)}}function Y(a){return function(e){var t=e||{},r=t.retrieveMappings,n=h(t,["retrieveMappings"]);return!0===r&&(n.getClusters=!0),a.transporter.read({method:s,path:"1/clusters/mapping/pending"},n)}}function Z(t){return function(e){return t.transporter.read({method:s,path:"1/keys"},e)}}function $(t){return function(e){return t.transporter.read({method:s,path:"1/clusters"},e)}}function ee(t){return function(e){return t.transporter.read({method:s,path:"1/indexes"},e)}}function te(t){return function(e){return t.transporter.read({method:s,path:"1/clusters/mapping"},e)}}function re(n){return function(r,e,t){return v(n.transporter.write({method:S,path:j("1/indexes/%s/operation",r),data:{operation:"move",destination:e}},t),function(e,t){return He(n)(r,{methods:{waitTask:Ye}}).waitTask(e.taskID,t)})}}function ne(n){return function(e,t){return v(n.transporter.write({method:S,path:"1/indexes/*/batch",data:{requests:e}},t),function(t,r){return Promise.all(Object.keys(t.taskID).map(function(e){return He(n)(e,{methods:{waitTask:Ye}}).waitTask(t.taskID[e],r)}))})}}function ae(r){return function(e,t){return r.transporter.read({method:S,path:"1/indexes/*/objects",data:{requests:e}},t)}}function oe(n){return function(e,t){var r=e.map(function(e){return P({},e,{params:k(e.params||{})})});return n.transporter.read({method:S,path:"1/indexes/*/queries",data:{requests:r},cacheable:!0},t)}}function ue(u){return function(e,o){return Promise.all(e.map(function(e){var t=e.params,r=t.facetName,n=t.facetQuery,a=h(t,["facetName","facetQuery"]);return He(u)(e.indexName,{methods:{searchForFacetValues:Le}}).searchForFacetValues(r,n,P({},o,{},a))}))}}function se(n){return function(e,t){var r=d(t);return r.queryParameters["X-Algolia-User-ID"]=e,n.transporter.write({method:u,path:"1/clusters/mapping"},r)}}function ie(a){return function(n,e){return v(a.transporter.write({method:S,path:j("1/keys/%s/restore",n)},e),function(e,r){return c(function(t){return Fe(a)(n,r).catch(function(e){if(404!==e.status)throw e;return t()})})})}}function ce(r){return function(e,t){return r.transporter.read({method:S,path:"1/clusters/mapping/search",data:{query:e}},t)}}function fe(i){return function(n,e){var a=Object.assign({},e),t=e||{},r=t.queryParameters,o=h(t,["queryParameters"]),u=r?{queryParameters:r}:{},s=["acl","indexes","referers","restrictSources","queryParameters","description","maxQueriesPerIPPerHour","maxHitsPerQuery"];return v(i.transporter.write({method:"PUT",path:j("1/keys/%s",n),data:u},o),function(e,t){return c(function(r){return Fe(i)(n,t).then(function(e){return t=e,Object.keys(a).filter(function(e){return-1!==s.indexOf(e)}).every(function(e){return t[e]===a[e]})?Promise.resolve():r();var t})})})}}function de(r){return function(e,t){return v(r.transporter.write({method:S,path:j("1/indexes/%s/batch",r.indexName),data:{requests:e}},t),function(e,t){return Ye(r)(e.taskID,t)})}}function le(r){return function(t){return n(P({shouldStop:function(e){return void 0===e.cursor}},t,{request:function(e){return r.transporter.read({method:S,path:j("1/indexes/%s/browse",r.indexName),data:e},t)}}))}}function pe(r){return function(e){var t=P({hitsPerPage:1e3},e);return n(P({shouldStop:function(e){return e.hits.length<t.hitsPerPage}},t,{request:function(e){return _e(r)("",P({},t,{},e)).then(function(e){return P({},e,{hits:e.hits.map(function(e){return delete e._highlightResult,e})})})}}))}}function he(r){return function(e){var t=P({hitsPerPage:1e3},e);return n(P({shouldStop:function(e){return e.hits.length<t.hitsPerPage}},t,{request:function(e){return Xe(r)("",P({},t,{},e)).then(function(e){return P({},e,{hits:e.hits.map(function(e){return delete e._highlightResult,e})})})}}))}}function me(c){return function(a,o,e){var t=e||{},u=t.batchSize,s=h(t,["batchSize"]),i={taskIDs:[],objectIDs:[]};return v(function t(e){for(var r=[],n=0<arguments.length&&void 0!==e?e:0;n<a.length&&(r.push(a[n]),r.length!==(u||1e3));n++);return 0===r.length?Promise.resolve(i):de(c)(r.map(function(e){return{action:o,body:e}}),s).then(function(e){return i.objectIDs=i.objectIDs.concat(e.objectIDs),i.taskIDs.push(e.taskID),t(++n)})}(),function(e,t){return Promise.all(e.taskIDs.map(function(e){return Ye(c)(e,t)}))})}}function ye(r){return function(e){return v(r.transporter.write({method:S,path:j("1/indexes/%s/clear",r.indexName)},e),function(e,t){return Ye(r)(e.taskID,t)})}}function ge(a){return function(e){var t=e||{},r=t.forwardToReplicas,n=d(h(t,["forwardToReplicas"]));return r&&(n.queryParameters.forwardToReplicas=1),v(a.transporter.write({method:S,path:j("1/indexes/%s/rules/clear",a.indexName)},n),function(e,t){return Ye(a)(e.taskID,t)})}}function ve(a){return function(e){var t=e||{},r=t.forwardToReplicas,n=d(h(t,["forwardToReplicas"]));return r&&(n.queryParameters.forwardToReplicas=1),v(a.transporter.write({method:S,path:j("1/indexes/%s/synonyms/clear",a.indexName)},n),function(e,t){return Ye(a)(e.taskID,t)})}}function be(r){return function(e,t){return v(r.transporter.write({method:S,path:j("1/indexes/%s/deleteByQuery",r.indexName),data:e},t),function(e,t){return Ye(r)(e.taskID,t)})}}function Pe(r){return function(e){return v(r.transporter.write({method:u,path:j("1/indexes/%s",r.indexName)},e),function(e,t){return Ye(r)(e.taskID,t)})}}function Oe(r){return function(e,t){return v(Me(r)([e],t).then(function(e){return{taskID:e.taskIDs[0]}}),function(e,t){return Ye(r)(e.taskID,t)})}}function je(o){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=d(h(r,["forwardToReplicas"]));return n&&(a.queryParameters.forwardToReplicas=1),v(o.transporter.write({method:u,path:j("1/indexes/%s/rules/%s",o.indexName,e)},a),function(e,t){return Ye(o)(e.taskID,t)})}}function we(o){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=d(h(r,["forwardToReplicas"]));return n&&(a.queryParameters.forwardToReplicas=1),v(o.transporter.write({method:u,path:j("1/indexes/%s/synonyms/%s",o.indexName,e)},a),function(e,t){return Ye(o)(e.taskID,t)})}}function Ie(t){return function(e){return Ke(t)(e).then(function(){return!0}).catch(function(e){if(404!==e.status)throw e;return!1})}}function xe(a){return function(s,e){var t=e||{},r=t.query,i=t.paginate,n=h(t,["query","paginate"]),c=0;return function u(){return Ve(a)(r||"",P({},n,{page:c})).then(function(e){for(var t=0,r=Object.entries(e.hits);t<r.length;t++){var n=m(r[t],2),a=n[0],o=n[1];if(s(o))return{object:o,position:parseInt(a,10),page:c}}if(c++,!1===i||c>=e.nbPages)throw{name:"ObjectNotFoundError",message:"Object not found."};return u()})}()}}function qe(r){return function(e,t){return r.transporter.read({method:s,path:j("1/indexes/%s/%s",r.indexName,e)},t)}}function De(){return function(e,t){for(var r=0,n=Object.entries(e.hits);r<n.length;r++){var a=m(n[r],2),o=a[0];if(a[1].objectID===t)return parseInt(o,10)}return-1}}function Se(u){return function(e,t){var r=t||{},n=r.attributesToRetrieve,a=h(r,["attributesToRetrieve"]),o=e.map(function(e){return P({indexName:u.indexName,objectID:e},n?{attributesToRetrieve:n}:{})});return u.transporter.read({method:S,path:"1/indexes/*/objects",data:{requests:o}},a)}}function Te(r){return function(e,t){return r.transporter.read({method:s,path:j("1/indexes/%s/rules/%s",r.indexName,e)},t)}}function ke(r){return function(e,t){return r.transporter.read({method:s,path:j("1/indexes/%s/synonyms/%s",r.indexName,e)},t)}}function Ne(r){return function(e,t){return v(We(r)([e],t).then(function(e){return{objectID:e.objectIDs[0],taskID:e.taskIDs[0]}}),function(e,t){return Ye(r)(e.taskID,t)})}}function Re(p){return function(t,e){function r(e,t,r,n){return v(p.transporter.write({method:S,path:j("1/indexes/%s/operation",e),data:{operation:r,destination:t}},n),function(e,t){return Ye(p)(e.taskID,t)})}var n=e||{},a=n.safe,o=n.autoGenerateObjectIDIfNotExist,u=n.batchSize,s=h(n,["safe","autoGenerateObjectIDIfNotExist","batchSize"]),i=Math.random().toString(36).substring(7),c="".concat(p.indexName,"_tmp_").concat(i),f=Be({appId:p.appId,transporter:p.transporter,indexName:c}),d=[],l=r(p.indexName,c,"copy",P({},s,{scope:["settings","synonyms","rules"]}));return d.push(l),v((a?l.wait(s):l).then(function(){var e=f(t,P({},s,{autoGenerateObjectIDIfNotExist:o,batchSize:u}));return d.push(e),a?e.wait(s):e}).then(function(){var e=r(c,p.indexName,"move",s);return d.push(e),a?e.wait(s):e}).then(function(){return Promise.all(d)}).then(function(e){var t=m(e,3),r=t[0],n=t[1],a=t[2];return{objectIDs:n.objectIDs,taskIDs:[r.taskID].concat(O(n.taskIDs),[a.taskID])}}),function(e,t){return Promise.all(d.map(function(e){return e.wait(t)}))})}}function Ae(r){return function(e,t){return Qe(r)(e,P({},t,{clearExistingRules:!0}))}}function Ee(r){return function(e,t){return Ge(r)(e,P({},t,{replaceExistingSynonyms:!0}))}}function Ce(r){return function(e,t){return v(Be(r)([e],t).then(function(e){return{objectID:e.objectIDs[0],taskID:e.taskIDs[0]}}),function(e,t){return Ye(r)(e.taskID,t)})}}function Ue(r){return function(e,t){return Qe(r)([e],t)}}function Je(r){return function(e,t){return Ge(r)([e],t)}}function ze(o){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=d(h(r,["forwardToReplicas"]));return n&&(a.queryParameters.forwardToReplicas=1),v(o.transporter.write({method:"PUT",path:j("1/indexes/%s/settings",o.indexName),data:e},a),function(e,t){return Ye(o)(e.taskID,t)})}}var Fe=function(r){return function(e,t){return r.transporter.read({method:s,path:j("1/keys/%s",e)},t)}},He=function(r){return function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return b({transporter:r.transporter,appId:r.appId,indexName:e},t.methods)}},Me=function(n){return function(e,t){var r=e.map(function(e){return{objectID:e}});return me(n)(r,Ze.DeleteObject,t)}},Ke=function(t){return function(e){return t.transporter.read({method:s,path:j("1/indexes/%s/settings",t.indexName),data:{getVersion:2}},e)}},We=function(u){return function(e,t){var r=t||{},n=r.createIfNotExists,a=h(r,["createIfNotExists"]),o=n?Ze.PartialUpdateObject:Ze.PartialUpdateObjectNoCreate;return me(u)(e,o,a)}},Be=function(d){return function(e,t){var r=t||{},n=r.autoGenerateObjectIDIfNotExist,a=h(r,["autoGenerateObjectIDIfNotExist"]),o=n?Ze.AddObject:Ze.UpdateObject;if(o===Ze.UpdateObject){var u=!0,s=!1,i=void 0;try{for(var c,f=e[Symbol.iterator]();!(u=(c=f.next()).done);u=!0)if(void 0===c.value.objectID)return v(Promise.reject({name:"MissingObjectIDError",message:"All objects must have an unique objectID (like a primary key) to be valid. Algolia is also able to generate objectIDs automatically but *it's not recommended*. To do it, use the `{'autoGenerateObjectIDIfNotExist': true}` option."}))}catch(e){s=!0,i=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw i}}}return me(d)(e,o,a)}},Qe=function(u){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=r.clearExistingRules,o=d(h(r,["forwardToReplicas","clearExistingRules"]));return n&&(o.queryParameters.forwardToReplicas=1),a&&(o.queryParameters.clearExistingRules=1),v(u.transporter.write({method:S,path:j("1/indexes/%s/rules/batch",u.indexName),data:e},o),function(e,t){return Ye(u)(e.taskID,t)})}},Ge=function(u){return function(e,t){var r=t||{},n=r.forwardToReplicas,a=r.replaceExistingSynonyms,o=d(h(r,["forwardToReplicas","replaceExistingSynonyms"]));return n&&(o.queryParameters.forwardToReplicas=1),a&&(o.queryParameters.replaceExistingSynonyms=1),v(u.transporter.write({method:S,path:j("1/indexes/%s/synonyms/batch",u.indexName),data:e},o),function(e,t){return Ye(u)(e.taskID,t)})}},Ve=function(r){return function(e,t){return r.transporter.read({method:S,path:j("1/indexes/%s/query",r.indexName),data:{query:e},cacheable:!0},t)}},Le=function(n){return function(e,t,r){return n.transporter.read({method:S,path:j("1/indexes/%s/facets/%s/query",n.indexName,e),data:{facetQuery:t},cacheable:!0},r)}},_e=function(r){return function(e,t){return r.transporter.read({method:S,path:j("1/indexes/%s/rules/search",r.indexName),data:{query:e}},t)}},Xe=function(r){return function(e,t){return r.transporter.read({method:S,path:j("1/indexes/%s/synonyms/search",r.indexName),data:{query:e}},t)}},Ye=function(a){return function(e,n){return c(function(t){return r=a,function(e,t){return r.transporter.read({method:s,path:j("1/indexes/%s/task/%s",r.indexName,e.toString())},t)}(e,n).then(function(e){return"published"!==e.status?t():void 0});var r})}},Ze={AddObject:"addObject",UpdateObject:"updateObject",PartialUpdateObject:"partialUpdateObject",PartialUpdateObjectNoCreate:"partialUpdateObjectNoCreate",DeleteObject:"deleteObject",DeleteIndex:"delete",ClearIndex:"clear"},i={Settings:"settings",Synonyms:"synonyms",Rules:"rules"};function e(e,t,r){var n,a,o,u,s,i,c,f,d={appId:e,apiKey:t,timeouts:{connect:1,read:2,write:30},requester:{send:function(o){return new Promise(function(r){var n=new XMLHttpRequest;n.open(o.method,o.url,!0),Object.keys(o.headers).forEach(function(e){return n.setRequestHeader(e,o.headers[e])});function e(e,t){return setTimeout(function(){n.abort(),r({status:0,content:t,isTimedOut:!0})},1e3*e)}var t,a=e(o.connectTimeout,"Connection timeout");n.onreadystatechange=function(){n.readyState>n.OPENED&&void 0===t&&(clearTimeout(a),t=e(o.responseTimeout,"Socket timeout"))},n.onerror=function(){0===n.status&&(clearTimeout(a),clearTimeout(t),r({content:n.responseText||"Network request failed",status:n.status,isTimedOut:!1}))},n.onload=function(){clearTimeout(a),clearTimeout(t),r({content:n.responseText,status:n.status,isTimedOut:!1})},n.send(o.data)})}},logger:{debug:function(e,t){return Promise.resolve()},info:function(e,t){return Promise.resolve()},error:function(e,t){return console.error(e,t),Promise.resolve()}},responsesCache:y(),requestsCache:y({serializable:!3}),hostsCache:function n(e){var a=O(e.caches),o=a.shift();return void 0===o?{get:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return t().then(function(e){return Promise.all([e,r.miss(e)])}).then(function(e){return m(e,1)[0]})},set:function(e,t){return Promise.resolve(t)},delete:function(e){return Promise.resolve()},clear:function(){return Promise.resolve()}}:{get:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return o.get(e,t,r).catch(function(){return n({caches:a}).get(e,t,r)})},set:function(e,t){return o.set(e,t).catch(function(){return n({caches:a}).set(e,t)})},delete:function(e){return o.delete(e).catch(function(){return n({caches:a}).delete(e)})},clear:function(){return o.clear().catch(function(){return n({caches:a}).clear()})}}}({caches:[(a={key:"".concat("4.3.0","-").concat(e)},u="algoliasearch-client-js-".concat(a.key),{get:function(r,n){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{miss:function(){return Promise.resolve()}};return Promise.resolve().then(function(){var e=JSON.stringify(r),t=p()[e];return Promise.all([t||n(),void 0!==t])}).then(function(e){var t=m(e,2),r=t[0],n=t[1];return Promise.all([r,n||a.miss(r)])}).then(function(e){return m(e,1)[0]})},set:function(t,r){return Promise.resolve().then(function(){var e=p();return e[JSON.stringify(t)]=r,l().setItem(u,JSON.stringify(e)),r})},delete:function(t){return Promise.resolve().then(function(){var e=p();delete e[JSON.stringify(t)],l().setItem(u,JSON.stringify(e))})},clear:function(){return Promise.resolve().then(function(){l().removeItem(u)})}}),y()]}),userAgent:(n={value:"Algolia for JavaScript (".concat("4.3.0",")"),add:function(e){var t="; ".concat(e.segment).concat(void 0!==e.version?" (".concat(e.version,")"):"");return-1===n.value.indexOf(t)&&(n.value="".concat(n.value).concat(t)),n}}).add({segment:"Browser"})};function l(){return void 0===o&&(o=a.localStorage||window.localStorage),o}function p(){return JSON.parse(l().getItem(u)||"{}")}return s=P({},d,{},r,{methods:{search:oe,searchForFacetValues:ue,multipleBatch:ne,multipleGetObjects:ae,multipleQueries:oe,copyIndex:W,copySettings:Q,copySynonyms:G,copyRules:B,moveIndex:re,listIndices:ee,getLogs:L,listClusters:$,multipleSearchForFacetValues:ue,getApiKey:Fe,addApiKey:H,listApiKeys:Z,updateApiKey:fe,deleteApiKey:V,restoreApiKey:ie,assignUserID:M,assignUserIDs:K,getUserID:X,searchUserIDs:ce,listUserIDs:te,getTopUserIDs:_,removeUserID:se,hasPendingMappings:Y,initIndex:function(t){return function(e){return He(t)(e,{methods:{batch:de,delete:Pe,getObject:qe,getObjects:Se,saveObject:Ce,saveObjects:Be,search:Ve,searchForFacetValues:Le,waitTask:Ye,setSettings:ze,getSettings:Ke,partialUpdateObject:Ne,partialUpdateObjects:We,deleteObject:Oe,deleteObjects:Me,deleteBy:be,clearObjects:ye,browseObjects:le,getObjectPosition:De,findObject:xe,exists:Ie,saveSynonym:Je,saveSynonyms:Ge,getSynonym:ke,searchSynonyms:Xe,browseSynonyms:he,deleteSynonym:we,clearSynonyms:ve,replaceAllObjects:Re,replaceAllSynonyms:Ee,searchRules:_e,getRule:Te,deleteRule:je,saveRule:Ue,saveRules:Qe,replaceAllRules:Ae,browseRules:pe,clearRules:ge}})}},initAnalytics:function(){return function(e){return t=P({},d,{},e,{methods:{addABTest:A,getABTest:C,getABTests:U,stopABTest:J,deleteABTest:E}}),r=t.region||"us",n=g(w.WithinHeaders,t.appId,t.apiKey),a=T(P({hosts:[{url:"analytics.".concat(r,".algolia.com")}]},t,{headers:P({},n.headers(),{},{"content-type":"application/json"},{},t.headers),queryParameters:P({},n.queryParameters(),{},t.queryParameters)})),b({appId:t.appId,transporter:a},t.methods);var t,r,n,a}},initRecommendation:function(){return function(e){return t=P({},d,{},e,{methods:{getPersonalizationStrategy:z,setPersonalizationStrategy:F}}),r=t.region||"us",n=g(w.WithinHeaders,t.appId,t.apiKey),a=T(P({hosts:[{url:"recommendation.".concat(r,".algolia.com")}]},t,{headers:P({},n.headers(),{},{"content-type":"application/json"},{},t.headers),queryParameters:P({},n.queryParameters(),{},t.queryParameters)})),b({appId:t.appId,transporter:a},t.methods);var t,r,n,a}}}}),i=s.appId,c=g(void 0!==s.authMode?s.authMode:w.WithinHeaders,i,s.apiKey),b({transporter:f=T(P({hosts:[{url:"".concat(i,"-dsn.algolia.net"),accept:I.Read},{url:"".concat(i,".algolia.net"),accept:I.Write}].concat(function(e){for(var t=e.length-1;0<t;t--){var r=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[r],e[r]=n}return e}([{url:"".concat(i,"-1.algolianet.com")},{url:"".concat(i,"-2.algolianet.com")},{url:"".concat(i,"-3.algolianet.com")}]))},s,{headers:P({},c.headers(),{},{"content-type":"application/x-www-form-urlencoded"},{},s.headers),queryParameters:P({},c.queryParameters(),{},s.queryParameters)})),appId:i,addAlgoliaAgent:function(e,t){f.userAgent.add({segment:e,version:t})},clearCache:function(){return Promise.all([f.requestsCache.clear(),f.responsesCache.clear()]).then(function(){})}},s.methods)}return e.version="4.3.0",e});